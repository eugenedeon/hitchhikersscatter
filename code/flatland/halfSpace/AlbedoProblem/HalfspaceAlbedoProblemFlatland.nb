(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    244392,       5410]
NotebookOptionsPosition[    225907,       5122]
NotebookOutlinePosition[    226261,       5138]
CellTagsIndexPosition[    226218,       5135]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Flatland Half Space, Albedo Problem, Isotropic Scattering", "Title",
 CellChangeTimes->{{3.61742787362737*^9, 3.617427885266508*^9}, {
  3.619592656668026*^9, 3.619592662680479*^9}, {3.621178701559973*^9, 
  3.621178702944907*^9}, {3.626744457954844*^9, 3.626744459455998*^9}, {
  3.6270128566699667`*^9, 3.62701287183559*^9}, {3.677299024329054*^9, 
  3.677299024855452*^9}, {3.67808633514688*^9, 3.678086343217737*^9}, {
  3.717601730891873*^9, 
  3.717601731679225*^9}},ExpressionUUID->"945888db-42c8-49ee-958e-\
9dd5718626bd"],

Cell["Exponential Random Flight", "Subtitle",
 CellChangeTimes->{{3.619594484416584*^9, 
  3.6195944880949802`*^9}},ExpressionUUID->"8546f458-c8a6-4706-8897-\
ca564bab4016"],

Cell[TextData[{
 "This is code to accompany the book:\n",
 StyleBox["A Hitchhiker\[CloseCurlyQuote]s Guide to Multiple Scattering\n", 
  "Subchapter"],
 StyleBox["\[Copyright] 2018", "Subsection"],
 StyleBox[" ", "Section"],
 StyleBox["Eugene d\[CloseCurlyQuote]Eon \nwww.eugenedeon.com", "Subsection"]
}], "Text",
 CellChangeTimes->{{3.6174286022468777`*^9, 3.617428710592918*^9}, {
  3.6410039396211576`*^9, 3.641003945296226*^9}, {3.645060407236547*^9, 
  3.645060444609275*^9}, {3.6772990291112137`*^9, 3.677299029295004*^9}, {
  3.717601735937079*^9, 3.7176017360151987`*^9}, {3.732938645312151*^9, 
  3.7329386457030363`*^9}},ExpressionUUID->"b723fccc-692a-4c7e-905a-\
4deb2dfa81a6"],

Cell[CellGroupData[{

Cell["Path Setup", "Section",
 CellChangeTimes->{{3.640928920990849*^9, 3.64092892141395*^9}, {
  3.640928986491934*^9, 
  3.640928986905283*^9}},ExpressionUUID->"f67a006d-c5db-477a-8e67-\
e9037b26f814"],

Cell["\<\
Put a file at ~/.hitchhikerpath with the path to your hitchhiker repo so that \
these worksheets can find the MC data from the C++ simulations for \
verification\
\>", "Text",
 CellChangeTimes->{{3.640928926126832*^9, 
  3.6409289600754013`*^9}},ExpressionUUID->"5af5a75c-e67c-4a0c-8f3d-\
7b9a30e5b894"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"Import", "[", "\"\<~/.hitchhikerpath\>\"", "]"}], "]"}]], "Input",
 CellLabel->
  "In[732]:=",ExpressionUUID->"2de1b81a-bbed-42ba-9aa3-c10b4498ba33"],

Cell[BoxData["\<\"/Users/eug/Documents/research/hitchhikersscatter\"\>"], \
"Output",
 CellChangeTimes->{3.723852980231256*^9, 3.7258250201928263`*^9, 
  3.7329387847347527`*^9, 3.734258990319648*^9, 3.7350952821044703`*^9, 
  3.736474719326324*^9, 3.745006313991379*^9, 3.748325087795258*^9, 
  3.752555238985826*^9, 3.761778526336611*^9},
 CellLabel->
  "Out[732]=",ExpressionUUID->"1281102e-c6e2-4840-b6b5-901ea7deb7e2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Notation", "Section",
 CellChangeTimes->{{3.617428538130481*^9, 
  3.617428538753331*^9}},ExpressionUUID->"fa6eb5d8-51fd-4f92-b110-\
375b6f24e333"],

Cell["\<\
\[Alpha] - single-scattering albedo
\[CapitalSigma]t - extinction coefficient
x - depth in medium (positive inside the scattering half space)
u = cos \[Theta] - direction cosine\
\>", "Text",
 CellChangeTimes->{{3.617428487341361*^9, 3.617428516514864*^9}, {
  3.62117873415422*^9, 3.621178738599084*^9}, {3.626744515152608*^9, 
  3.6267445586349487`*^9}, {3.627012891843924*^9, 3.627012912866523*^9}, {
  3.649256344957097*^9, 3.649256385822545*^9}, {3.678086358929956*^9, 
  3.678086372624774*^9}, {3.7176017850695677`*^9, 
  3.71760178515758*^9}},ExpressionUUID->"9f0f012a-fb64-4e3e-8c55-\
50b646f0d36d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Load MC Data", "Section",
 CellChangeTimes->{{3.617427964847665*^9, 3.617427965662361*^9}, {
  3.6174280073412037`*^9, 3.617428007556081*^9}, {3.640936210100869*^9, 
  3.640936211771452*^9}, {3.678086953635509*^9, 
  3.6780869562832727`*^9}},ExpressionUUID->"bd110267-8782-471c-9a40-\
5826de020bc5"],

Cell[CellGroupData[{

Cell["Delta Incidence", "Subsection",
 CellChangeTimes->{{3.678086946572081*^9, 3.678086967675282*^9}, {
  3.6780871170653467`*^9, 
  3.678087119758628*^9}},ExpressionUUID->"6235391a-be51-4697-b108-\
1da0bb0a2436"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`deltafs", "=", 
   RowBox[{
   "FileNames", "[", 
    "\"\<code/flatland/halfspace/albedoProblem/data/albedoproblem_delta*.txt\>\
\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.678086976996827*^9, 3.678087014259712*^9}, {
  3.678087065568762*^9, 3.678087110199113*^9}, {3.678087140544381*^9, 
  3.678087140934195*^9}, {3.7176019733265743`*^9, 3.7176019863798447`*^9}},
 CellLabel->
  "In[733]:=",ExpressionUUID->"27a407c4-c272-42a6-8efc-187e75ac29ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "FlatlandhalfspaceAlbedoProblemIsotropic`indexdelta", "[", "x_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"data", ",", "\[Alpha]", ",", "\[CapitalSigma]t", ",", "ui"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"x", ",", "\"\<Table\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalSigma]t", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"ui", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", 
          RowBox[{"-", "4"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"\[Alpha]", ",", "\[CapitalSigma]t", ",", "ui", ",", "data"}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.717602088693499*^9},
 CellLabel->
  "In[734]:=",ExpressionUUID->"0fce930d-955e-4a77-a06c-f2a1d3427cb6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`simulationsdelta", "=", 
   RowBox[{
   "FlatlandhalfspaceAlbedoProblemIsotropic`indexdelta", "/@", 
    "FlatlandhalfspaceAlbedoProblemIsotropic`deltafs"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`alphas", "=", 
  RowBox[{"Union", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
    "FlatlandhalfspaceAlbedoProblemIsotropic`simulationsdelta"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.717602097237547*^9, 3.7176021025415163`*^9}, {
  3.763660539398963*^9, 3.7636605397359858`*^9}},
 CellLabel->
  "In[735]:=",ExpressionUUID->"0478cbea-a17b-4712-b5ce-4c5ad1afbbd4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.01`", ",", "0.1`", ",", "0.3`", ",", "0.5`", ",", "0.7`", ",", "0.8`", 
   ",", "0.9`", ",", "0.95`", ",", "0.99`", ",", "0.999`"}], "}"}]], "Output",\

 CellChangeTimes->{3.7176021061830873`*^9, 3.717602285835648*^9, 
  3.723852985891795*^9, 3.7258250259788523`*^9, 3.732938791635433*^9, 
  3.734259132514346*^9, 3.735095239496222*^9, 3.735095288053172*^9, 
  3.736474724915723*^9, 3.7450063190492*^9, 3.7483250930417767`*^9, 
  3.752555243613062*^9, 3.75370909920264*^9, 3.761778531261199*^9},
 CellLabel->
  "Out[736]=",ExpressionUUID->"b5222b4a-0b4d-49f3-963a-c4e8c02b9cf5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`muts", "=", 
  RowBox[{"Union", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
    "FlatlandhalfspaceAlbedoProblemIsotropic`simulationsdelta"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.717602125902042*^9, 3.717602127102022*^9}},
 CellLabel->
  "In[737]:=",ExpressionUUID->"1df45b87-45ec-43ff-83b1-c566b8051491"],

Cell[BoxData[
 RowBox[{"{", "1", "}"}]], "Output",
 CellChangeTimes->{3.717602285910326*^9, 3.723852986031966*^9, 
  3.725825026236918*^9, 3.7329387919483833`*^9, 3.734259132638339*^9, 
  3.7350952395719423`*^9, 3.735095288202182*^9, 3.73647472502778*^9, 
  3.745006319150728*^9, 3.7483250934621477`*^9, 3.752555243770063*^9, 
  3.753709099383747*^9, 3.761778531434815*^9},
 CellLabel->
  "Out[737]=",ExpressionUUID->"c17759fc-3516-4104-b59f-fcf9dacec214"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`uis", "=", 
  RowBox[{"Union", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", 
    "FlatlandhalfspaceAlbedoProblemIsotropic`simulationsdelta"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7176021285498466`*^9, 3.717602129750001*^9}},
 CellLabel->
  "In[738]:=",ExpressionUUID->"b522e711-6a26-4dbe-b3cf-3fc936454036"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.1`", ",", "0.25`", ",", "0.5`", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.7176022859678383`*^9, 3.7238529861081867`*^9, 
  3.7258250263691883`*^9, 3.732938792020816*^9, 3.734259132708387*^9, 
  3.735095239627351*^9, 3.735095288301137*^9, 3.736474725101918*^9, 
  3.7450063192220793`*^9, 3.748325093525075*^9, 3.752555243829687*^9, 
  3.7537090994629383`*^9, 3.761778531519346*^9},
 CellLabel->
  "Out[738]=",ExpressionUUID->"e6765383-37bb-41b5-a1d3-57ee234f1200"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`numcollorders", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
     "FlatlandhalfspaceAlbedoProblemIsotropic`simulationsdelta", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "4", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "13"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`maxz", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
     "FlatlandhalfspaceAlbedoProblemIsotropic`simulationsdelta", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "4", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "7"}], "]"}], "]"}]}], ";", 
  RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`dz", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
     "FlatlandhalfspaceAlbedoProblemIsotropic`simulationsdelta", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "4", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "9"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`numz", "=", 
   RowBox[{"Floor", "[", 
    RowBox[{
    "FlatlandhalfspaceAlbedoProblemIsotropic`maxz", "/", 
     "FlatlandhalfspaceAlbedoProblemIsotropic`dz"}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.717602131327672*^9, 3.7176021427903023`*^9}},
 CellLabel->
  "In[739]:=",ExpressionUUID->"f663403d-e476-4d25-a6cb-6be614579cb5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["WhiteSky Illumination", "Subsection",
 CellChangeTimes->{{3.678086946572081*^9, 3.678086967675282*^9}, {
  3.6780871170653467`*^9, 3.678087119758628*^9}, {3.67835246988898*^9, 
  3.67835247713661*^9}},ExpressionUUID->"ac265462-18bf-4df6-97bf-\
0e4e7491d3ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`whiteskyfs", "=", 
   RowBox[{
   "FileNames", "[", 
    "\"\<code/flatland/halfspace/albedoProblem/data/albedoproblem_whitesky*.\
txt\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.678086976996827*^9, 3.678087014259712*^9}, {
   3.678087065568762*^9, 3.678087110199113*^9}, {3.678087140544381*^9, 
   3.678087140934195*^9}, {3.678352482691983*^9, 3.678352489192762*^9}, 
   3.735319043934721*^9, {3.735319075252214*^9, 3.735319090142728*^9}},
 CellLabel->
  "In[742]:=",ExpressionUUID->"b82e591e-007a-482a-a258-b21706477bd5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
   "FlatlandhalfspaceAlbedoProblemIsotropic`indexwhitesky", "[", "x_", "]"}], 
   ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"data", ",", "\[Alpha]", ",", "\[CapitalSigma]t"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"x", ",", "\"\<Table\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalSigma]t", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"{", 
       RowBox[{"\[Alpha]", ",", "\[CapitalSigma]t", ",", "data"}], "}"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "FlatlandhalfspaceAlbedoProblemIsotropic`simulationswhitesky", "=", 
   RowBox[{
   "FlatlandhalfspaceAlbedoProblemIsotropic`indexwhitesky", "/@", 
    "FlatlandhalfspaceAlbedoProblemIsotropic`whiteskyfs"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.678087162664856*^9, 3.678087223822651*^9}, {
  3.678087318794619*^9, 3.678087352495007*^9}, {3.678352496192567*^9, 
  3.6783525349427147`*^9}, {3.679780720959332*^9, 3.67978072212598*^9}, {
  3.735319045794065*^9, 3.7353190503266087`*^9}},
 CellLabel->
  "In[743]:=",ExpressionUUID->"4987ded2-6106-4b40-85f2-6456e3e6cb95"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Util", "Subsection",
 CellChangeTimes->{{3.6783815697884808`*^9, 3.678381570148775*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints", "[", 
    RowBox[{"data_", ",", "du_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"du", " ", "i"}], " ", "-", " ", 
        RowBox[{"0.5", " ", "du"}]}], ",", 
       RowBox[{"data", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6783815736105022`*^9, 3.678381617418*^9}, {
   3.6783828408499107`*^9, 3.678382841109769*^9}, 3.7176022035002317`*^9},
 CellLabel->
  "In[745]:=",ExpressionUUID->"8ee6f682-5cb8-4a9b-9a6b-b9fb3d5d879e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints2", "[", 
    RowBox[{"data_", ",", "du_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"du", " ", "i"}], " ", "-", " ", 
        RowBox[{"0.5", " ", "du"}]}], ",", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", "i", "]"}], "]"}], 
        FractionBox[
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"du", " ", "i"}], " ", "-", " ", 
              RowBox[{"0.5", " ", "du"}]}], ")"}], "2"]}]], "2"]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.717603604961042*^9, 3.7176036356972*^9}, {
  3.717603676380837*^9, 3.7176036808350058`*^9}},
 CellLabel->
  "In[746]:=",ExpressionUUID->"e6560500-7bec-43bb-9447-fe6bb0725ba7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints", "[", 
    RowBox[{"data_", ",", "d_", ",", "min_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"min", "+", 
        RowBox[{"d", " ", "i"}], " ", "-", " ", 
        RowBox[{"0.5", " ", "d"}]}], ",", 
       RowBox[{"data", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.679782606935545*^9, 3.6797826436214*^9}, 
   3.7176022048282337`*^9},
 CellLabel->
  "In[747]:=",ExpressionUUID->"37ee9a46-9904-4c3f-b9ad-0914e87e60a5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Deterministic Solutions", "Section",
 CellChangeTimes->{{3.735095024382169*^9, 
  3.7350950289808197`*^9}},ExpressionUUID->"eaee646b-c165-40de-8d18-\
1174a0d57ad3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IFock", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "2"}], " ", 
    RowBox[{"(", "x", ")"}], " ", 
    RowBox[{"ArcTanh", "[", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", "x", ")"}]}]], "]"}]}], "-", 
   RowBox[{"2", " ", "\[ImaginaryI]", " ", 
    RowBox[{"PolyLog", "[", 
     RowBox[{"2", ",", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", "x", ")"}]}]]}], "]"}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"PolyLog", "[", 
     RowBox[{"2", ",", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        RowBox[{"(", "x", ")"}]}]]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7524628339498453`*^9, 3.752462843474553*^9}, {
  3.752462911483304*^9, 3.752462916402958*^9}},
 CellLabel->
  "In[748]:=",ExpressionUUID->"7f5fbb28-c1e4-47d6-b3dc-15eb5742afbe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Flatland`H4", "[", 
   RowBox[{"u_", ",", "c_"}], "]"}], ":=", " ", 
  RowBox[{
   SqrtBox[
    FractionBox[
     RowBox[{"1", "+", "u"}], 
     RowBox[{"1", "+", 
      RowBox[{"u", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c", "2"]}]]}]}]]], 
   RowBox[{"Abs", "[", 
    RowBox[{"Exp", "[", 
     RowBox[{
      FractionBox["1", "Pi"], 
      RowBox[{"IFock", "[", 
       RowBox[{
        RowBox[{"ArcSec", "[", "u", "]"}], "+", 
        RowBox[{"ArcSin", "[", "c", "]"}]}], "]"}]}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.752508730914456*^9, 3.752508754117958*^9}},
 CellLabel->
  "In[749]:=",ExpressionUUID->"15241764-f98f-4547-bb85-906d85966893"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`H", "[", 
   RowBox[{"c_", ",", "u_"}], "]"}], ":=", 
  RowBox[{
   SqrtBox[
    FractionBox[
     RowBox[{"1", "+", "u"}], 
     RowBox[{"1", "+", 
      RowBox[{"u", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c", "2"]}]]}]}]]], 
   RowBox[{"Abs", "[", 
    RowBox[{"Exp", "[", 
     RowBox[{
      FractionBox["1", "Pi"], 
      RowBox[{"IFock", "[", 
       RowBox[{
        RowBox[{"ArcSec", "[", "u", "]"}], "+", 
        RowBox[{"ArcSin", "[", "c", "]"}]}], "]"}]}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7176024128071003`*^9, 3.71760251589965*^9}, 
   3.717605712934703*^9, {3.717903676480451*^9, 3.717903701724461*^9}, 
   3.752555330340253*^9},
 CellLabel->
  "In[750]:=",ExpressionUUID->"0d7ce3b7-9355-4b58-8e94-d5d3014b79f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`H", "[", 
   RowBox[{"c_", ",", "0"}], "]"}], ":=", "1"}]], "Input",
 CellChangeTimes->{{3.7364853307483263`*^9, 3.736485334030788*^9}},
 CellLabel->
  "In[751]:=",ExpressionUUID->"740b6843-a2d4-48b5-9ab5-8c2ba4a41693"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`Hmoment", "[", 
   RowBox[{"\[Alpha]_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Quiet", "[", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`H", "[", 
       RowBox[{"\[Alpha]", ",", "u"}], "]"}], 
      SuperscriptBox["u", "j"], 
      FractionBox["2", 
       RowBox[{"Pi", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["u", "2"]}]]}]]}], ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.734279650921123*^9, 3.734279653324464*^9}, {
  3.734570532010014*^9, 3.734570535713101*^9}, {3.734570659232623*^9, 
  3.7345706595419083`*^9}, {3.735095638301783*^9, 3.735095640209036*^9}, {
  3.7365431280627604`*^9, 3.736543130121937*^9}},
 CellLabel->
  "In[752]:=",ExpressionUUID->"b9a8e169-5f9c-4436-8661-e8ead8eb7683"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Angular Moments", "Section",
 CellChangeTimes->{{3.681363451521307*^9, 
  3.681363453591572*^9}},ExpressionUUID->"ad104d27-00b8-4fe6-9781-\
e3982b2c2ae1"],

Cell[CellGroupData[{

Cell["Delta-Illumination angular moments of exitant flux", "Subsection",
 CellChangeTimes->{{3.6815337201393547`*^9, 
  3.681533725576936*^9}},ExpressionUUID->"e6c0b09e-73f5-41ae-bb51-\
247c7f5e0189"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`angularMmoments", "[", 
   RowBox[{"\[Alpha]_", ",", "ui_", ",", "H_", ",", "Hmoment_"}], "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"1", "-", 
     RowBox[{
      SqrtBox[
       RowBox[{"1", "-", "\[Alpha]"}]], " ", 
      RowBox[{"H", "[", "ui", "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"ui", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{
        RowBox[{"H", "[", "ui", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox[
           RowBox[{"1", "-", "\[Alpha]"}]], "+", 
          FractionBox[
           RowBox[{"\[Alpha]", " ", 
            RowBox[{"Hmoment", "[", "1", "]"}]}], 
           RowBox[{"2", " ", "ui"}]]}], ")"}]}]}], ")"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     SuperscriptBox["ui", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"H", "[", "ui", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           SqrtBox[
            RowBox[{"1", "-", "\[Alpha]"}]]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", "\[Alpha]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"Hmoment", "[", "1", "]"}], "ui"]}], "+", 
             FractionBox[
              RowBox[{"Hmoment", "[", "2", "]"}], 
              SuperscriptBox["ui", "2"]]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
   "\[IndentingNewLine]", "}"}]}]], "Input",
 CellChangeTimes->{{3.681533644796187*^9, 3.6815337046185217`*^9}, 
   3.68153374753822*^9, 3.734279765008342*^9},
 CellLabel->
  "In[209]:=",ExpressionUUID->"37939309-7501-4e54-8d98-3f69c7bc9bca"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Diffuse Illumination angular moments of exitant flux", "Subsection",
 CellChangeTimes->{{3.681533733792634*^9, 3.6815337391926126`*^9}, {
  3.736542799839797*^9, 
  3.736542800408052*^9}},ExpressionUUID->"768bf1db-87e7-471f-95bf-\
69ca3693c211"],

Cell["3D:", "Text",
 CellChangeTimes->{{3.73654280638927*^9, 
  3.736542806889989*^9}},ExpressionUUID->"717ad0dd-5c5f-437e-8921-\
054a5e325877"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HalfspaceAlbedoProblemIsotropic`angularMmoments", "[", 
   RowBox[{"c_", ",", "Hmoment_"}], "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"1", "-", 
     RowBox[{"2", " ", 
      SqrtBox[
       RowBox[{"1", "-", "c"}]], " ", 
      RowBox[{"Hmoment", "[", "1", "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     FractionBox["2", "3"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", "c", " ", 
           SuperscriptBox[
            RowBox[{"Hmoment", "[", "1", "]"}], "2"]}], "+", 
          RowBox[{
           SqrtBox[
            RowBox[{"1", "-", "c"}]], " ", 
           RowBox[{"Hmoment", "[", "2", "]"}]}]}], ")"}]}]}], ")"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"4", " ", 
        SqrtBox[
         RowBox[{"1", "-", "c"}]], " ", 
        RowBox[{"Hmoment", "[", "3", "]"}]}]}], ")"}]}]}], 
   "\[IndentingNewLine]", "}"}]}]], "Input",
 CellChangeTimes->{{3.6815346705211143`*^9, 3.681534701143955*^9}, {
   3.681534778422949*^9, 3.68153478586983*^9}, 3.735319000161384*^9, 
   3.736485645794256*^9, 3.7365431615023327`*^9},
 CellLabel->
  "In[210]:=",ExpressionUUID->"7824c651-46e5-46ea-a030-d2135468e01c"],

Cell["Flatland:", "Text",
 CellChangeTimes->{{3.736542809492889*^9, 
  3.7365428102619877`*^9}},ExpressionUUID->"1a3dc62b-2f3d-49a3-91ab-\
146a5c59cd1a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`angularMmoments", "[", 
   RowBox[{"c_", ",", "Hmoment_"}], "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"1", "-", " ", 
     RowBox[{
      FractionBox["Pi", "2"], 
      SqrtBox[
       RowBox[{"1", "-", "c"}]], " ", 
      RowBox[{"Hmoment", "[", "1", "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["\[Pi]", "4"]}], "+", " ", 
     RowBox[{
      FractionBox["Pi", "2"], 
      SqrtBox[
       RowBox[{"1", "-", "c"}]], " ", 
      RowBox[{"Hmoment", "[", "2", "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[Pi]", " ", "c", " ", 
      SuperscriptBox[
       RowBox[{"Hmoment", "[", "1", "]"}], "2"]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     FractionBox["2", "3"], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SqrtBox[
       RowBox[{"1", "-", "c"}]], " ", "\[Pi]", " ", 
      RowBox[{"Hmoment", "[", "3", "]"}]}]}]}], "\[IndentingNewLine]", 
   "}"}]}]], "Input",
 CellChangeTimes->{
  3.736485653633336*^9, {3.736485765333334*^9, 3.736485767139225*^9}, {
   3.736485911964764*^9, 3.736485915279273*^9}, {3.736486014560278*^9, 
   3.7364860154702806`*^9}, {3.736542247805887*^9, 3.736542266915743*^9}, {
   3.736542380682026*^9, 3.73654239363299*^9}, {3.7365425675271187`*^9, 
   3.7365425924295692`*^9}, {3.7365426912685823`*^9, 3.736542746209058*^9}},
 CellLabel->
  "In[211]:=",ExpressionUUID->"9e0ee1a2-91ba-456f-a266-b3469bdfd84e"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Fluence Moments", "Section",
 CellChangeTimes->{{3.681363459697064*^9, 
  3.681363463551363*^9}},ExpressionUUID->"d8720cf6-94a0-4e31-bbc8-\
f43b6952d17a"],

Cell[CellGroupData[{

Cell["Delta-Illumination spatial fluence moments", "Subsection",
 CellChangeTimes->{{3.6815535079824953`*^9, 
  3.6815535142994843`*^9}},ExpressionUUID->"e0121f01-3dc3-474c-8d74-\
1dff1ebbae57"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`x", "[", 
    RowBox[{"c_", ",", "0", ",", "ui_", ",", "Hmoment_"}], "]"}], ":=", "1"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`x", "[", 
   RowBox[{"c_", ",", "n_", ",", "ui_", ",", "Hmoment_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"n", "!"}], 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["ui", "n"], "+", 
     RowBox[{
      FractionBox["c", 
       RowBox[{"2", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "c"}], ")"}], 
         RowBox[{"1", "/", "2"}]]}]], 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"Hmoment", "[", "j", "]"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "j"}], ")"}], "!"}]], 
         RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`x", "[", 
          RowBox[{"c", ",", 
           RowBox[{"n", "-", "j"}], ",", "ui", ",", "Hmoment"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}], 
    ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.6815530242924223`*^9, 3.6815531195418386`*^9}, {
   3.681706406277114*^9, 3.681706413366148*^9}, {3.681706479018536*^9, 
   3.681706497854917*^9}, {3.6817066449696712`*^9, 3.681706645890155*^9}, {
   3.7342797778943644`*^9, 3.734279779466826*^9}, 3.734280513915111*^9},
 CellLabel->
  "In[214]:=",ExpressionUUID->"8e601f1c-df87-4c6d-b31c-792d7b89b69a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`spatialMoments", "[", 
   RowBox[{"c_", ",", "ui_", ",", "H_", ",", "Hmoment_"}], "]"}], ":=", " ", 
  RowBox[{
   FractionBox[
    RowBox[{"H", "[", "ui", "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", "c"}], ")"}], 
     RowBox[{"1", "/", "2"}]]], 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`x", "[", 
      RowBox[{"c", ",", "n", ",", "ui", ",", "Hmoment"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "4"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.681706397415625*^9, 3.681706432714485*^9}, {
   3.6817065040710077`*^9, 3.681706505046466*^9}, {3.681706578572641*^9, 
   3.681706580810482*^9}, 3.681706649393506*^9, 3.734279780842792*^9, 
   3.734280439459703*^9},
 CellLabel->
  "In[216]:=",ExpressionUUID->"b4b38c64-9812-4ffa-ac2f-b6db4a0dc934"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Diffuse Illumination spatial fluence moments", "Subsection",
 CellChangeTimes->{{3.6815348791088877`*^9, 3.681534887914844*^9}, {
  3.736544745040723*^9, 
  3.736544745673077*^9}},ExpressionUUID->"0db2a920-0980-484d-a1bd-\
e2a0955f3082"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HalfspaceAlbedoProblemIsotropic`spatialMoments", "[", 
   RowBox[{"c_", ",", "Hmoment_"}], "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"Hmoment", "[", "1", "]"}]}], 
     SqrtBox[
      RowBox[{"1", "-", "c"}]]], ",", "\[IndentingNewLine]", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"c", " ", 
         SuperscriptBox[
          RowBox[{"Hmoment", "[", "1", "]"}], "2"]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "c"}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{"Hmoment", "[", "2", "]"}], 
        SqrtBox[
         RowBox[{"1", "-", "c"}]]]}], ")"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["c", "2"], " ", 
         SuperscriptBox[
          RowBox[{"Hmoment", "[", "1", "]"}], "3"]}], 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "c"}], ")"}], 
          RowBox[{"3", "/", "2"}]]}]], "+", 
       FractionBox[
        RowBox[{"2", " ", "c", " ", 
         RowBox[{"Hmoment", "[", "1", "]"}], " ", 
         RowBox[{"Hmoment", "[", "2", "]"}]}], 
        RowBox[{"1", "-", "c"}]], "+", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"Hmoment", "[", "3", "]"}]}], 
        SqrtBox[
         RowBox[{"1", "-", "c"}]]]}], ")"}]}]}], "\[IndentingNewLine]", 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.681534902380179*^9, 3.681534977721939*^9}, 
   3.734279783306554*^9, {3.7353203626143513`*^9, 3.735320397502904*^9}, {
   3.7357177225611477`*^9, 3.735717733169014*^9}, 3.736544895872724*^9},
 CellLabel->
  "In[217]:=",ExpressionUUID->"81939790-b04d-49ca-8bd5-6afee500bbe8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`spatialMoments", "[", 
   RowBox[{"c_", ",", "Hmoment_"}], "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     FractionBox["Pi", "2"], 
     FractionBox[
      RowBox[{" ", 
       RowBox[{"Hmoment", "[", "1", "]"}]}], 
      SqrtBox[
       RowBox[{"1", "-", "c"}]]]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     FractionBox["Pi", "2"], 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"c", " ", 
         SuperscriptBox[
          RowBox[{"Hmoment", "[", "1", "]"}], "2"]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "c"}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{"Hmoment", "[", "2", "]"}], 
        SqrtBox[
         RowBox[{"1", "-", "c"}]]]}], ")"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     FractionBox["Pi", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["c", "2"], " ", 
         SuperscriptBox[
          RowBox[{"Hmoment", "[", "1", "]"}], "3"]}], 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "c"}], ")"}], 
          RowBox[{"3", "/", "2"}]]}]], "+", 
       FractionBox[
        RowBox[{"2", " ", "c", " ", 
         RowBox[{"Hmoment", "[", "1", "]"}], " ", 
         RowBox[{"Hmoment", "[", "2", "]"}]}], 
        RowBox[{"1", "-", "c"}]], "+", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"Hmoment", "[", "3", "]"}]}], 
        SqrtBox[
         RowBox[{"1", "-", "c"}]]]}], ")"}]}]}], "\[IndentingNewLine]", 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.7365449020521317`*^9, 3.736544908030858*^9}, {
  3.7365454410510073`*^9, 3.7365454446049023`*^9}, {3.736545496339007*^9, 
  3.736545540741091*^9}, {3.736545601406866*^9, 3.736545602177375*^9}},
 CellLabel->
  "In[218]:=",ExpressionUUID->"ebb5a143-0bac-4305-ad0a-fcb889983667"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["BRDF", "Section",
 CellChangeTimes->{{3.6783518675356007`*^9, 3.678351867959366*^9}}],

Cell[CellGroupData[{

Cell["Exact Solution", "Subsection",
 CellChangeTimes->{{3.678243290233646*^9, 3.6782432907699747`*^9}, {
  3.678244600875744*^9, 3.6782446034766703`*^9}, {3.678351871470203*^9, 
  3.678351878439619*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`BRDF", "[", 
   RowBox[{"\[Alpha]_", ",", "ui_", ",", "uo_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", "Pi", 
     RowBox[{"(", 
      RowBox[{"ui", "+", "uo"}], ")"}]}]], "\[Alpha]", " ", 
   RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`H", "[", 
    RowBox[{"\[Alpha]", ",", "ui"}], "]"}], 
   RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`H", "[", 
    RowBox[{"\[Alpha]", ",", "uo"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.678243305861866*^9, 3.6782433355144367`*^9}, {
  3.678382723771881*^9, 3.67838272580593*^9}, {3.71760260087352*^9, 
  3.717602608072473*^9}, {3.717605834801896*^9, 3.717605834951353*^9}},
 CellLabel->
  "In[753]:=",ExpressionUUID->"87380738-ebfc-4be8-88fe-f694c6f48061"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`BRDFsinglescatter", "[", 
   RowBox[{"\[Alpha]_", ",", "ui_", ",", "uo_"}], "]"}], ":=", 
  RowBox[{"\[Alpha]", " ", 
   FractionBox["1", 
    RowBox[{"2", " ", "Pi"}]], 
   FractionBox["1", 
    RowBox[{"ui", "+", "uo"}]]}]}]], "Input",
 CellChangeTimes->{{3.67824336328697*^9, 3.678243375075954*^9}, {
   3.6783831486067257`*^9, 3.67838314981422*^9}, 3.717602613744011*^9, {
   3.7176058380973177`*^9, 3.7176058382792587`*^9}},
 CellLabel->
  "In[754]:=",ExpressionUUID->"634917d0-2559-4d52-b2c0-8f321ff11224"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`BRDFdoublescatter", "[", 
   RowBox[{"c_", ",", "ui_", ",", "uo_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"ArcSec", "[", "ui", "]"}], 
       SqrtBox[
        RowBox[{"1", "-", 
         FractionBox["1", 
          SuperscriptBox["ui", "2"]]}]]], "+", 
      FractionBox[
       RowBox[{"ArcSec", "[", "uo", "]"}], 
       SqrtBox[
        RowBox[{"1", "-", 
         FractionBox["1", 
          SuperscriptBox["uo", "2"]]}]]]}], ")"}], " ", 
    SuperscriptBox["c", "2"]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["\[Pi]", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"ui", "+", "uo"}], ")"}]}]]}]], "Input",
 CellChangeTimes->{{3.678243383779813*^9, 3.678243399287198*^9}, {
   3.678383152878263*^9, 3.6783831540063877`*^9}, 3.717602617593952*^9, {
   3.717605840063949*^9, 3.71760584980304*^9}},
 CellLabel->
  "In[755]:=",ExpressionUUID->"fdeb89b4-373b-4ff7-b1dc-c3c02ced7519"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Albedo", "Section",
 CellChangeTimes->{{3.678351849474118*^9, 3.678351854522242*^9}}],

Cell[CellGroupData[{

Cell["Exact Solution", "Subsection",
 CellChangeTimes->{{3.57810145582381*^9, 3.57810146131748*^9}, {
  3.678086667711203*^9, 3.6780866708386106`*^9}, {3.6783518807977543`*^9, 
  3.678351882542946*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`albedoexact", "[", 
   RowBox[{"\[Alpha]_", ",", "ui_"}], "]"}], ":=", 
  RowBox[{"1", "-", 
   RowBox[{
    SqrtBox[
     RowBox[{"1", "-", "\[Alpha]"}]], 
    RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`H", "[", 
     RowBox[{"\[Alpha]", ",", "ui"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.578101465840554*^9, 3.5781015027088823`*^9}, {
  3.67808667418025*^9, 3.6780867412371283`*^9}, {3.678243522617496*^9, 
  3.678243524540243*^9}, {3.678353149811701*^9, 3.6783531690275507`*^9}, {
  3.717616405546089*^9, 3.717616409058095*^9}},
 CellLabel->
  "In[756]:=",ExpressionUUID->"535f3245-e099-4ac2-b30f-6e3e6fd0fe79"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Single-scattered Albedo (Exact Solution)", "Subsection",
 CellChangeTimes->{
  3.678244507206736*^9, {3.6782445852851343`*^9, 3.6782445927810583`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "FlatlandhalfspaceAlbedoProblemIsotropic`albedoSingleScatterExact", "[", 
   RowBox[{"c_", ",", "ui_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"ui", "<", "1"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], "-", 
       FractionBox[
        RowBox[{"ArcSec", "[", "ui", "]"}], 
        RowBox[{"\[Pi]", " ", 
         SqrtBox[
          RowBox[{"1", "-", 
           FractionBox["1", 
            SuperscriptBox["ui", "2"]]}]]}]]}], ")"}], "c"}], ",", 
    FractionBox[
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "\[Pi]"}], ")"}]}], 
     RowBox[{"2", " ", "\[Pi]"}]]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6782446126121397`*^9, 3.67824463613031*^9}, 
   3.717617118240881*^9, {3.717617637139152*^9, 3.717617639318165*^9}, {
   3.717618282115265*^9, 3.717618290985408*^9}, {3.717715087203883*^9, 
   3.717715091833282*^9}},
 CellLabel->
  "In[757]:=",ExpressionUUID->"c86a5ff0-825d-4344-a579-ec4f2e19758b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "FlatlandhalfspaceAlbedoProblemIsotropic`albedoSingleScatterExact", "[", 
   "c_", "]"}], ":=", 
  RowBox[{
   FractionBox["1", "16"], " ", "c", " ", 
   RowBox[{"(", 
    RowBox[{"12", "-", 
     RowBox[{"3", " ", "\[Pi]"}], "+", 
     FractionBox[
      RowBox[{"MeijerG", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "2"]}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           FractionBox["3", "2"], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "2"]}], ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", "}"}]}], "}"}], ",", "1"}], "]"}], 
      SqrtBox["\[Pi]"]]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.7526908377971373`*^9, 3.752690843069613*^9}},
 CellLabel->
  "In[758]:=",ExpressionUUID->"13e9b342-3d70-4ec8-9140-7ecd90795f67"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Double-scattered Albedo (Exact Solution)", "Subsection",
 CellChangeTimes->{
  3.678244507206736*^9, {3.6782445852851343`*^9, 3.6782445927810583`*^9}, {
   3.678244662379245*^9, 3.678244665481461*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "FlatlandhalfspaceAlbedoProblemIsotropic`albedoDoubleScatterExact", "[", 
    RowBox[{"c_", ",", "ui_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ui", "<", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "8"], "+", 
        FractionBox["ui", 
         RowBox[{"4", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["ui", "2"]}], ")"}]}]], "-", 
        FractionBox[
         SuperscriptBox["ui", "2"], 
         RowBox[{"4", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["ui", "2"]}], ")"}]}]], "+", 
        FractionBox[
         RowBox[{"ArcSec", "[", "ui", "]"}], 
         RowBox[{"2", " ", "\[Pi]", " ", 
          SqrtBox[
           RowBox[{"1", "-", 
            FractionBox["1", 
             SuperscriptBox["ui", "2"]]}]]}]], "-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["ui", "2"], " ", 
          SuperscriptBox[
           RowBox[{"ArcSec", "[", "ui", "]"}], "2"]}], 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Pi]", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["ui", "2"]}], ")"}]}]]}], ")"}], " ", 
      SuperscriptBox["c", "2"]}], ",", "\[IndentingNewLine]", 
     FractionBox[
      RowBox[{
       SuperscriptBox["c", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Pi]"}], ")"}]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["\[Pi]", "2"]}]]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6782446126121397`*^9, 3.67824463613031*^9}, {
   3.6782446709475403`*^9, 3.678244690301235*^9}, 3.679765633357095*^9, {
   3.681350162069508*^9, 3.6813501624945602`*^9}, 3.7176171289293756`*^9, {
   3.717618300595501*^9, 3.7176183103032703`*^9}, 3.717714546856371*^9, {
   3.717714904992923*^9, 3.7177149188480177`*^9}, 3.7177149499126167`*^9},
 CellLabel->
  "In[759]:=",ExpressionUUID->"770cdf80-7220-4bb4-89d2-637b0db3e415"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Caseology Flatland", "Section",
 CellChangeTimes->{{3.678355615249607*^9, 3.678355616361288*^9}, {
  3.735095974421401*^9, 
  3.735095976159153*^9}},ExpressionUUID->"0b13436d-d1d1-4a9d-816b-\
b230df90b911"],

Cell[CellGroupData[{

Cell["Caseology quantities", "Subsection",
 CellChangeTimes->{{3.6774776567694683`*^9, 3.67747765747231*^9}, {
  3.67747833237188*^9, 
  3.6774783443299837`*^9}},ExpressionUUID->"72878afa-6ecc-4220-9b83-\
043f00459bad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Flatland`CaseN0", "[", 
   RowBox[{"c_", ",", "v0_"}], "]"}], ":=", 
  FractionBox[
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["c", "2"]}]], 
   RowBox[{"2", " ", "Pi", " ", "c"}]]}]], "Input",
 CellChangeTimes->{{3.735095980836424*^9, 3.7350959834110327`*^9}, {
  3.735096330155821*^9, 3.735096338886299*^9}},
 CellLabel->
  "In[771]:=",ExpressionUUID->"215415c4-c3ca-48e0-b094-203952f9dab3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Flatland`Casev0", "[", "c_", "]"}], ":=", 
  FractionBox["1", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["c", "2"]}]]]}]], "Input",
 CellChangeTimes->{
  3.677478195414242*^9, {3.677478595620187*^9, 3.677478607699188*^9}, 
   3.6797656188648376`*^9, {3.735095989387703*^9, 3.735096001925544*^9}, {
   3.735096179425501*^9, 3.7350961810536537`*^9}, {3.735096472081173*^9, 
   3.735096479989337*^9}},
 CellLabel->
  "In[772]:=",ExpressionUUID->"0f9246e0-b71d-4f1f-8f71-82df28ca0110"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Flatland`CaseN", "[", 
   RowBox[{"c_", ",", "v_"}], "]"}], ":=", 
  RowBox[{"v", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Flatland`Case\[Lambda]", "[", 
       RowBox[{"v", ",", "c"}], "]"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{"\[Pi]", " ", "c", " ", "v"}], "2"], ")"}], "2"]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{3.735096010901231*^9, 3.735168222555979*^9},
 CellLabel->
  "In[773]:=",ExpressionUUID->"2f41b708-9503-4586-8d24-aeb40b8cc8df"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Flatland`Case\[Lambda]", "[", 
   RowBox[{"v_", ",", "c_"}], "]"}], ":=", "1"}]], "Input",
 CellChangeTimes->{3.735096011702114*^9, 3.735168216492304*^9},
 CellLabel->
  "In[774]:=",ExpressionUUID->"a9156c8f-e1a1-4680-bb36-9a1cd5563a38"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Flatland`Case\[Psi]0", "[", 
   RowBox[{"u_", ",", "v0_", ",", "c_", ",", "z_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["c", 
    RowBox[{"2", " ", "Pi"}]], 
   FractionBox["v0", 
    RowBox[{"v0", "-", 
     RowBox[{
      RowBox[{"Sign", "[", "z", "]"}], "u"}]}]]}]}]], "Input",
 CellChangeTimes->{{3.6779997021186533`*^9, 3.677999752315556*^9}, {
   3.67799978953563*^9, 3.677999810171295*^9}, {3.67800046092441*^9, 
   3.678000471198715*^9}, 3.735096012557382*^9, {3.7350960561227493`*^9, 
   3.7350960566269197`*^9}},
 CellLabel->
  "In[775]:=",ExpressionUUID->"b6a415c1-5e12-4223-9f00-54a3dd00b0ce"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Internal Distribution", "Section",
 CellChangeTimes->{{3.735095824491499*^9, 
  3.735095826748192*^9}},ExpressionUUID->"0774118e-aa81-4929-a777-\
6b97e4b41c48"],

Cell[CellGroupData[{

Cell["Fluence - Delta Illumination (Exact)", "Subsection",
 CellChangeTimes->{{3.735167475424335*^9, 
  3.735167481710869*^9}},ExpressionUUID->"a1e58abd-8057-488e-be54-\
316a0c7f1346"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`\[Phi]exact", "[", 
   RowBox[{"z_", ",", "\[Alpha]_", ",", "ui_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`H", "[", 
       RowBox[{"\[Alpha]", ",", "ui"}], "]"}], 
      RowBox[{"2", "Pi"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Flatland`Case\[Psi]0", "[", 
           RowBox[{"ui", ",", "#", ",", "\[Alpha]", ",", "z"}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Flatland`CaseN0", "[", 
             RowBox[{"\[Alpha]", ",", "#"}], "]"}], 
            RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`H", "[", 
             RowBox[{"\[Alpha]", ",", "#"}], "]"}]}], ")"}]}], ")"}], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "z"}], "/", "#"}], "]"}]}], "+", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Flatland`Case\[Psi]0", "[", 
             RowBox[{"ui", ",", "v", ",", "\[Alpha]", ",", "1"}], "]"}], 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "z"}], "/", "v"}], "]"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Flatland`CaseN", "[", 
             RowBox[{"\[Alpha]", ",", "v"}], "]"}], 
            RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`H", "[", 
             RowBox[{"\[Alpha]", ",", "v"}], "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"v", ",", "0", ",", "ui", ",", "1"}], "}"}], ",", 
         RowBox[{"Method", "\[Rule]", "\"\<PrincipalValue\>\""}], ",", 
         RowBox[{"PrecisionGoal", "\[Rule]", "5"}]}], "]"}], "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ui", "<", "1"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "z"}], "/", "ui"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Flatland`CaseN", "[", 
               RowBox[{"\[Alpha]", ",", "ui"}], "]"}], 
              RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`H", "[", 
               RowBox[{"\[Alpha]", ",", "ui"}], "]"}]}], ")"}]}], ")"}], 
          RowBox[{"Flatland`Case\[Lambda]", "[", 
           RowBox[{"ui", ",", "\[Alpha]"}], "]"}]}], ",", "0"}], "]"}]}], 
      ")"}]}], "&"}], "[", 
   RowBox[{"Flatland`Casev0", "[", "\[Alpha]", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7351674861748962`*^9, 3.735167522568672*^9}, 
   3.735167859652652*^9},
 CellLabel->
  "In[887]:=",ExpressionUUID->"ae982385-fb1f-487e-9d94-3fd9ededeb28"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fluence - Delta Illumination (Rigorous Diffusion)", "Subsection",
 CellChangeTimes->{{3.678464097685503*^9, 3.678464099558835*^9}, {
  3.678464131636458*^9, 3.6784641329581757`*^9}, {3.67901164491044*^9, 
  3.679011680358988*^9}},ExpressionUUID->"14f294cd-60d5-47ac-b152-\
aacaec5cb136"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "FlatlandhalfspaceAlbedoProblemIsotropic`\[Phi]rigorousdiffusion", "[", 
   RowBox[{"z_", ",", "\[Alpha]_", ",", "ui_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`H", "[", 
       RowBox[{"\[Alpha]", ",", "ui"}], "]"}], 
      RowBox[{"2", " ", "Pi"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Flatland`Case\[Psi]0", "[", 
          RowBox[{"ui", ",", "#", ",", "\[Alpha]", ",", "z"}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Flatland`CaseN0", "[", 
            RowBox[{"\[Alpha]", ",", "#"}], "]"}], 
           RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`H", "[", 
            RowBox[{"\[Alpha]", ",", "#"}], "]"}]}], ")"}]}], ")"}], 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "z"}], "/", " ", "#"}], "]"}]}], ")"}]}], "&"}], "[", 
   RowBox[{"Flatland`Casev0", "[", "\[Alpha]", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.678465724602989*^9, {3.678465775309465*^9, 3.6784657775014763`*^9}, {
   3.735095854085191*^9, 3.73509585986014*^9}, 3.735095954283696*^9, {
   3.735096014892514*^9, 3.7350960211901083`*^9}, 3.735151120607292*^9},
 CellLabel->
  "In[888]:=",ExpressionUUID->"fec81196-c131-4e97-95ae-516f0a64b771"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "FlatlandhalfspaceAlbedoProblemIsotropic`\[Phi]rigorousdiffusion", "[", 
   RowBox[{"z_", ",", "\[Alpha]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox["1", 
      RowBox[{" ", "Pi"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", " ", 
           SqrtBox[
            RowBox[{"1", "-", "\[Alpha]"}]]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Flatland`CaseN0", "[", 
            RowBox[{"\[Alpha]", ",", "#"}], "]"}], 
           RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`H", "[", 
            RowBox[{"\[Alpha]", ",", "#"}], "]"}]}], ")"}]}], ")"}], 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "z"}], "/", "#"}], "]"}]}], ")"}]}], "&"}], "[", 
   RowBox[{"Flatland`Casev0", "[", "\[Alpha]", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.735327026217906*^9, 3.7353270621516247`*^9}},
 CellLabel->
  "In[769]:=",ExpressionUUID->"f1342642-2b04-478c-8fa8-6e3123b7f858"]
}, Open  ]],

Cell[CellGroupData[{

Cell["White-Sky Illumination - Fluence - (Rigorous Diffusion)", "Subsection",
 CellChangeTimes->{{3.6797810490842543`*^9, 3.6797810541791687`*^9}, {
   3.6797814205621643`*^9, 3.679781425488174*^9}, {3.6813599644204283`*^9, 
   3.6813599665075607`*^9}, 
   3.7353269695127363`*^9},ExpressionUUID->"d641b15e-ef2d-4591-bb20-\
25a5891265e9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "imdata", ",", "sim", ",", "dz", ",", "maxz", ",", "fluence3", ",", 
        "fluence", ",", "stride", ",", "numzs"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sim", "=", 
        RowBox[{"SelectFirst", "[", 
         RowBox[{
         "FlatlandhalfspaceAlbedoProblemIsotropic`simulationswhitesky", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
            
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
             "\[CapitalSigma]t"}]}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"imdata", "=", 
        RowBox[{"sim", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"maxz", "=", 
        RowBox[{"imdata", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "7"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dz", "=", 
        RowBox[{"imdata", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "9"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"stride", "=", "3"}], ";", "\[IndentingNewLine]", 
       RowBox[{"numzs", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"imdata", "[", 
          RowBox[{"[", "13", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fluence", "=", 
        RowBox[{
         RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints", "[", 
          RowBox[{
           RowBox[{"imdata", "[", 
            RowBox[{"[", "13", "]"}], "]"}], ",", "dz"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", 
           RowBox[{"Floor", "[", 
            RowBox[{"numzs", "/", "5"}], "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fluence3", "=", 
        RowBox[{
         RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints", "[", 
          RowBox[{
           RowBox[{"imdata", "[", 
            RowBox[{"[", "13", "]"}], "]"}], ",", "dz"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", 
           RowBox[{"-", "1"}], ";;", "stride"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
        RowBox[{"GraphicsRow", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Show", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Plot", "[", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    FractionBox["Pi", "2"], ")"}], "1"], " ", 
                  RowBox[{"(", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"-", 
                    FractionBox["z", 
                    FractionBox["1", 
                    SqrtBox[
                    RowBox[{"1", "-", 
                    SuperscriptBox["\[Alpha]", "2"]}]]]]}]], " ", 
                    FractionBox["1", 
                    SqrtBox[
                    RowBox[{"1", "-", 
                    SuperscriptBox["\[Alpha]", "2"]}]]], " ", 
                    SqrtBox[
                    RowBox[{"1", "-", "\[Alpha]"}]]}], 
                    RowBox[{
                    FractionBox[
                    SqrtBox[
                    RowBox[{"1", "-", 
                    SuperscriptBox["\[Alpha]", "2"]}]], 
                    RowBox[{"2", " ", "\[Alpha]"}]], " ", "\[Pi]", " ", 
                    RowBox[{"H", "[", 
                    RowBox[{
                    FractionBox["1", 
                    SqrtBox[
                    RowBox[{"1", "-", 
                    SuperscriptBox["\[Alpha]", "2"]}]]], ",", "\[Alpha]", ",",
                     "2"}], "]"}]}]], ")"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"z", ",", "0", ",", 
                   FractionBox["maxz", "5"]}], "}"}], ",", 
                 RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ListPlot", "[", 
                RowBox[{"fluence", ",", 
                 RowBox[{"PlotStyle", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"PointSize", "[", "0.004", "]"}], ",", "Black"}], 
                   "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Phi]", "[", "z", "]"}], ","}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"z", ",", 
                  RowBox[{
                  "\"\<Fluence \[Phi](z): isotropically-scattering half space \
white-Sky illumination\\n indexed-matched boundary, \[Alpha] = \>\"", "<>", 
                   RowBox[{"ToString", "[", "\[Alpha]", "]"}]}]}], "}"}]}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Show", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"LogPlot", "[", 
                RowBox[{
                 RowBox[{"2", "Pi", 
                  RowBox[{"(", 
                   FractionBox["Pi", "2"], ")"}], " ", 
                  RowBox[{"(", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"-", 
                    FractionBox["z", 
                    FractionBox["1", 
                    SqrtBox[
                    RowBox[{"1", "-", 
                    SuperscriptBox["\[Alpha]", "2"]}]]]]}]], " ", 
                    FractionBox["1", 
                    SqrtBox[
                    RowBox[{"1", "-", 
                    SuperscriptBox["\[Alpha]", "2"]}]]], " ", 
                    SqrtBox[
                    RowBox[{"1", "-", "\[Alpha]"}]]}], 
                    RowBox[{
                    FractionBox[
                    SqrtBox[
                    RowBox[{"1", "-", 
                    SuperscriptBox["\[Alpha]", "2"]}]], 
                    RowBox[{"2", " ", "\[Alpha]"}]], " ", "\[Pi]", " ", 
                    RowBox[{"H", "[", 
                    RowBox[{
                    FractionBox["1", 
                    SqrtBox[
                    RowBox[{"1", "-", 
                    SuperscriptBox["\[Alpha]", "2"]}]]], ",", "\[Alpha]", ",",
                     "2"}], "]"}]}]], ")"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"z", ",", "0", ",", "maxz"}], "}"}], ",", 
                 RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ListLogPlot", "[", 
                RowBox[{"fluence3", ",", 
                 RowBox[{"PlotStyle", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"PointSize", "[", "0.004", "]"}], ",", "Black"}], 
                   "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Phi]", "[", "z", "]"}], ","}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"z", ",", 
                  RowBox[{
                  "\"\<Fluence \[Phi](z): isotropically-scattering half space \
white-Sky illumination\\n indexed-matched boundary, \[Alpha] = \>\"", "<>", 
                   RowBox[{"ToString", "[", "\[Alpha]", "]"}]}]}], "}"}]}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "}"}], "]"}], "\[IndentingNewLine]", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Alpha]", ",", "0.3"}], "}"}], ",", 
      "FlatlandhalfspaceAlbedoProblemIsotropic`alphas"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
     "\[CapitalSigma]t", ",", 
      "FlatlandhalfspaceAlbedoProblemIsotropic`muts"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.678243714363831*^9, 3.678243802473928*^9}, {
   3.6782438372745743`*^9, 3.678243918405334*^9}, {3.678244848477655*^9, 
   3.678244871652142*^9}, 3.678244974528975*^9, {3.6783812459205103`*^9, 
   3.678381252573442*^9}, {3.678381299886239*^9, 3.678381302440772*^9}, {
   3.678381482937087*^9, 3.67838152124067*^9}, {3.6783816672515917`*^9, 
   3.678381901224969*^9}, {3.6783819833752737`*^9, 3.678381984893968*^9}, {
   3.678382028434991*^9, 3.678382051113124*^9}, {3.678382476562173*^9, 
   3.678382531616342*^9}, {3.6783825770739527`*^9, 3.6783826434825163`*^9}, {
   3.678382818564744*^9, 3.678382822589374*^9}, {3.6783830180371923`*^9, 
   3.678383070242436*^9}, {3.678383105394609*^9, 3.678383124360643*^9}, {
   3.67838317595117*^9, 3.678383188135069*^9}, {3.678383240059972*^9, 
   3.678383266639002*^9}, {3.6783833301136513`*^9, 3.678383335323216*^9}, {
   3.6783833670062733`*^9, 3.678383463817894*^9}, {3.678383521513876*^9, 
   3.6783835456193733`*^9}, {3.678386332154438*^9, 3.678386560606522*^9}, {
   3.678465505399572*^9, 3.678465538006304*^9}, {3.678465595345571*^9, 
   3.678465657415832*^9}, {3.6784788259692574`*^9, 3.678478861255927*^9}, {
   3.6784790017886677`*^9, 3.6784790764906883`*^9}, {3.67847912413452*^9, 
   3.6784791297973347`*^9}, {3.6790108325055857`*^9, 3.679010850916103*^9}, {
   3.679011009036701*^9, 3.679011009308338*^9}, 3.6790112868995256`*^9, {
   3.67902348087889*^9, 3.679023481708637*^9}, 3.679023648763858*^9, 
   3.679023893722725*^9, {3.679024040083886*^9, 3.679024042826344*^9}, {
   3.679778319713251*^9, 3.679778326542061*^9}, {3.679780908227364*^9, 
   3.679780910009165*^9}, {3.6813503292376842`*^9, 3.681350329548441*^9}, {
   3.681350617607449*^9, 3.681350619603817*^9}, {3.681350840373707*^9, 
   3.681350840788444*^9}, {3.6813599747657347`*^9, 3.681359986836121*^9}, {
   3.681360027202428*^9, 3.681360034345829*^9}, {3.681360095377928*^9, 
   3.68136009562429*^9}, {3.681875947633127*^9, 3.681875947934149*^9}, {
   3.6818759924260283`*^9, 3.681876002740102*^9}, {3.681876048596408*^9, 
   3.6818760565049953`*^9}, 3.681876097031455*^9, {3.735326972997423*^9, 
   3.735326994083333*^9}, {3.753751655976742*^9, 3.753751666707736*^9}, {
   3.753754206489191*^9, 3.7537542261000977`*^9}, {3.753764094064521*^9, 
   3.753764149869153*^9}, {3.7537643837169657`*^9, 3.75376443299613*^9}, {
   3.753764467625207*^9, 3.7537644828012133`*^9}, {3.753764545756627*^9, 
   3.7537645783565683`*^9}},
 CellLabel->
  "In[823]:=",ExpressionUUID->"488d312c-8d35-4ada-a69d-97acedbab037"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`\[Alpha]$$ = 
    0.9, $CellContext`\[CapitalSigma]t$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`\[Alpha]$$], 0.3}, {0.01, 0.1, 0.3, 0.5, 0.7, 0.8, 
      0.9, 0.95, 0.99, 0.999}}, {
      Hold[$CellContext`\[CapitalSigma]t$$], {1}}}, Typeset`size$$ = {
    1079., {166., 170.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`\[Alpha]$4209671$$ = 
    0, $CellContext`\[CapitalSigma]t$4209672$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`\[Alpha]$$ = 
        0.3, $CellContext`\[CapitalSigma]t$$ = 1}, "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$4209671$$, 0], 
        Hold[$CellContext`\[CapitalSigma]t$$, \
$CellContext`\[CapitalSigma]t$4209672$$, False]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`imdata$, $CellContext`sim$, $CellContext`dz$, \
$CellContext`maxz$, $CellContext`fluence3$, $CellContext`fluence$, \
$CellContext`stride$, $CellContext`numzs$}, $CellContext`sim$ = 
         SelectFirst[
          FlatlandhalfspaceAlbedoProblemIsotropic`simulationswhitesky, And[
           Part[#, 1] == $CellContext`\[Alpha]$$, 
            Part[#, 2] == $CellContext`\[CapitalSigma]t$$]& ]; \
$CellContext`imdata$ = Part[$CellContext`sim$, 3]; $CellContext`maxz$ = 
         Part[$CellContext`imdata$, 2, 7]; $CellContext`dz$ = 
         Part[$CellContext`imdata$, 2, 9]; $CellContext`stride$ = 
         3; $CellContext`numzs$ = Length[
           Part[$CellContext`imdata$, 13]]; $CellContext`fluence$ = Part[
           FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints[
            Part[$CellContext`imdata$, 13], $CellContext`dz$], 
           Span[1, 
            Floor[$CellContext`numzs$/5]]]; $CellContext`fluence3$ = Part[
           FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints[
            Part[$CellContext`imdata$, 13], $CellContext`dz$], 
           Span[1, -1, $CellContext`stride$]]; Quiet[
          GraphicsRow[{
            Show[
             Show[
              
              Plot[(Pi/2)^1 (
                E^(-($CellContext`z/(1/Sqrt[
                   1 - $CellContext`\[Alpha]$$^2]))) (1/Sqrt[
                 1 - $CellContext`\[Alpha]$$^2]) 
                Sqrt[1 - $CellContext`\[Alpha]$$]/((
                 Sqrt[1 - $CellContext`\[Alpha]$$^2]/(
                 2 $CellContext`\[Alpha]$$)) 
                Pi $CellContext`H[
                 1/Sqrt[1 - $CellContext`\[Alpha]$$^2], \
$CellContext`\[Alpha]$$, 2])), {$CellContext`z, 0, $CellContext`maxz$/5}, 
               PlotRange -> All], 
              ListPlot[$CellContext`fluence$, PlotStyle -> {
                 PointSize[0.004], Black}]], Frame -> True, ImageSize -> 500, 
             FrameLabel -> {{
                $CellContext`\[Phi][$CellContext`z], Null}, {$CellContext`z, 
                StringJoin[
                "Fluence \[Phi](z): isotropically-scattering half space \
white-Sky illumination\n indexed-matched boundary, \[Alpha] = ", 
                 ToString[$CellContext`\[Alpha]$$]]}}], 
            Show[
             Show[
              LogPlot[
              2 Pi (Pi/2) (
                E^(-($CellContext`z/(1/Sqrt[
                   1 - $CellContext`\[Alpha]$$^2]))) (1/Sqrt[
                 1 - $CellContext`\[Alpha]$$^2]) 
                Sqrt[1 - $CellContext`\[Alpha]$$]/((
                 Sqrt[1 - $CellContext`\[Alpha]$$^2]/(
                 2 $CellContext`\[Alpha]$$)) 
                Pi $CellContext`H[
                 1/Sqrt[1 - $CellContext`\[Alpha]$$^2], \
$CellContext`\[Alpha]$$, 2])), {$CellContext`z, 0, $CellContext`maxz$}, 
               PlotRange -> All], 
              ListLogPlot[$CellContext`fluence3$, PlotStyle -> {
                 PointSize[0.004], Black}]], Frame -> True, ImageSize -> 500, 
             FrameLabel -> {{
                $CellContext`\[Phi][$CellContext`z], Null}, {$CellContext`z, 
                StringJoin[
                "Fluence \[Phi](z): isotropically-scattering half space \
white-Sky illumination\n indexed-matched boundary, \[Alpha] = ", 
                 ToString[$CellContext`\[Alpha]$$]]}}]}]]], 
      "Specifications" :> {{{$CellContext`\[Alpha]$$, 0.3}, {0.01, 0.1, 0.3, 
         0.5, 0.7, 0.8, 0.9, 0.95, 0.99, 
         0.999}}, {$CellContext`\[CapitalSigma]t$$, {1}}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{1124., {224., 230.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.681360579419942*^9, {3.681875936196521*^9, 3.681875951786643*^9}, 
   3.681876007776989*^9, {3.68187605413654*^9, 3.681876063614493*^9}, 
   3.681876177515793*^9, 3.681880102883608*^9, 3.735326994532119*^9, 
   3.735327052875978*^9, 3.745006347637505*^9, {3.753751637269656*^9, 
   3.753751667663938*^9}, 3.753754227337451*^9, 3.753764394480542*^9, 
   3.753764433979991*^9, {3.753764469073382*^9, 3.7537644846318617`*^9}, {
   3.753764547626775*^9, 3.753764578768468*^9}},
 CellLabel->
  "Out[823]=",ExpressionUUID->"5a530654-dc7d-457a-af06-cc8214146dba"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Albedo Benchmarks", "Section",
 CellChangeTimes->{{3.6782455819149513`*^9, 3.678245590673798*^9}}],

Cell[CellGroupData[{

Cell["Albedo - Delta Illumination - General incidence", "Subsection",
 CellChangeTimes->{{3.6782436990841293`*^9, 3.678243709674959*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "Rs", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Rs", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"Select", "[", 
          RowBox[{
          "FlatlandhalfspaceAlbedoProblemIsotropic`simulationsdelta", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "ui"}], "&"}]}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Quiet", "[", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Show", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ListLogLinearPlot", "[", 
             RowBox[{"Rs", ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Black"}], 
                "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"LogLinearPlot", "[", 
             RowBox[{
              RowBox[{"Quiet", "[", 
               RowBox[{
               "FlatlandhalfspaceAlbedoProblemIsotropic`albedoexact", "[", 
                RowBox[{"c", ",", "ui"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"c", ",", "0.001", ",", ".9999"}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"R", "[", 
                RowBox[{"\[Alpha]", ",", "ui"}], "]"}], ","}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Single scattering albedo: \[Alpha]\>\"", ",", 
               RowBox[{
               "\"\<Total Reflectance/Albedo \
R(\[Alpha],\!\(\*SubscriptBox[\(u\), \(i\)]\)): isotropically-scattering half \
space\\nincidence (\!\(\*SubscriptBox[\(u\), \(i\)]\)=\>\"", "<>", 
                RowBox[{"ToString", "[", "ui", "]"}], "<>", 
                "\"\<), indexed-matched boundary\>\""}]}], "}"}]}], "}"}]}]}],
          "\[IndentingNewLine]", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"ui", ",", "FlatlandhalfspaceAlbedoProblemIsotropic`uis"}], 
     "}"}]}], "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.678243714363831*^9, 3.678243802473928*^9}, {
   3.6782438372745743`*^9, 3.678243918405334*^9}, {3.678244848477655*^9, 
   3.678244871652142*^9}, 3.678244974528975*^9, {3.717617191165825*^9, 
   3.717617195237575*^9}, {3.717627896661762*^9, 3.717627897402671*^9}, {
   3.717627981313841*^9, 3.7176279832089653`*^9}, {3.7176282907020187`*^9, 
   3.7176282911469297`*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"971c0d91-81da-4465-a531-377fe10cbb8b"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`ui$$ = 0.1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`ui$$], {0.1, 0.25, 0.5, 1}}}, Typeset`size$$ = {
    360., {130., 134.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`ui$10601$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`ui$$ = 0.1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`ui$$, $CellContext`ui$10601$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`Rs$}, $CellContext`Rs$ = Map[{
            Part[#, 1], 
            Part[
             Part[#, 4], 3, 3]}& , 
           Select[
           FlatlandhalfspaceAlbedoProblemIsotropic`simulationsdelta, 
            Part[#, 3] == $CellContext`ui$$& ]]; Quiet[
          Show[
           Show[
            ListLogLinearPlot[$CellContext`Rs$, PlotStyle -> {
               PointSize[0.01], Black}], 
            LogLinearPlot[
             Quiet[
              
              FlatlandhalfspaceAlbedoProblemIsotropic`albedoexact[$\
CellContext`c, $CellContext`ui$$]], {$CellContext`c, 0.001, 0.9999}, 
             PlotRange -> All]], Frame -> True, FrameLabel -> {{
              $CellContext`R[$CellContext`\[Alpha], $CellContext`ui$$], 
              Null}, {"Single scattering albedo: \[Alpha]", 
              StringJoin[
              "Total Reflectance/Albedo R(\[Alpha],\!\(\*SubscriptBox[\(u\), \
\(i\)]\)): isotropically-scattering half space\nincidence \
(\!\(\*SubscriptBox[\(u\), \(i\)]\)=", 
               ToString[$CellContext`ui$$], 
               "), indexed-matched boundary"]}}]]], 
      "Specifications" :> {{$CellContext`ui$$, {0.1, 0.25, 0.5, 1}}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{405., {173., 179.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.678243803720525*^9, {3.678243862430122*^9, 3.678243919649342*^9}, {
   3.678244850878378*^9, 3.678244872837129*^9}, 3.6782449759668913`*^9, 
   3.6797656647874117`*^9, 3.679778033715375*^9, 3.679780785570218*^9, 
   3.680341306186005*^9, 3.6813496633457823`*^9, 3.681880089088526*^9, 
   3.717617195871455*^9, 3.7176278987198067`*^9, 3.717627986655609*^9, 
   3.717628292445621*^9, {3.7350952341334953`*^9, 3.73509525667918*^9}, 
   3.73509529602711*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"f59f5117-701f-4eec-a29f-fc6136d3dc0a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Single & Double-Scattered Albedo - Delta Illumination - General incidence\
\>", "Subsection",
 CellChangeTimes->{{3.6782436990841293`*^9, 3.678243709674959*^9}, {
  3.6782444023640213`*^9, 3.678244406923081*^9}, {3.678244732672474*^9, 
  3.678244733647873*^9}, {3.678245601346274*^9, 3.678245601576996*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"RsSingle", ",", "RsDouble"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RsSingle", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"5", ",", "2"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
        RowBox[{"Select", "[", 
         RowBox[{
         "FlatlandhalfspaceAlbedoProblemIsotropic`simulationsdelta", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "ui"}], "&"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"RsDouble", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"5", ",", "3"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
        RowBox[{"Select", "[", 
         RowBox[{
         "FlatlandhalfspaceAlbedoProblemIsotropic`simulationsdelta", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "ui"}], "&"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pASS", "=", 
       RowBox[{"Quiet", "[", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Show", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ListLogLinearPlot", "[", 
             RowBox[{"RsSingle", ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Black"}], 
                "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"ListLogLinearPlot", "[", 
             RowBox[{"RsDouble", ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Black"}], 
                "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"LogLinearPlot", "[", 
             RowBox[{
              RowBox[{"Quiet", "[", 
               RowBox[{
               "FlatlandhalfspaceAlbedoProblemIsotropic`\
albedoSingleScatterExact", "[", 
                RowBox[{"c", ",", "ui"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"c", ",", "0.001", ",", ".9999"}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Dashed"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"LogLinearPlot", "[", 
             RowBox[{
              RowBox[{"Quiet", "[", 
               RowBox[{
               "FlatlandhalfspaceAlbedoProblemIsotropic`\
albedoDoubleScatterExact", "[", 
                RowBox[{"c", ",", "ui"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"c", ",", "0.001", ",", ".9999"}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                SubscriptBox["R", "n"], "[", 
                RowBox[{"\[Alpha]", ",", "ui"}], "]"}], ","}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Single scattering albedo: \[Alpha]\>\"", ",", 
               RowBox[{
               "\"\<Single (Dashed) and Double-Scattered Reflectance/Albedo \
\!\(\*SubscriptBox[\(R\), \(n\)]\)(\[Alpha],\!\(\*SubscriptBox[\(u\), \
\(i\)]\)): \\nisotropically-scattering half space\\nincidence \
(\!\(\*SubscriptBox[\(u\), \(i\)]\)=\>\"", "<>", 
                RowBox[{"ToString", "[", "ui", "]"}], "<>", 
                "\"\<), indexed-matched boundary\>\""}]}], "}"}]}], "}"}]}]}],
          "\[IndentingNewLine]", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"ui", ",", "FlatlandhalfspaceAlbedoProblemIsotropic`uis"}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.678244480442157*^9, 3.678244481425602*^9}, {
   3.678244737940098*^9, 3.678244838565442*^9}, 3.678244876112692*^9, {
   3.678244970067155*^9, 3.678244970289199*^9}, {3.6782451581726713`*^9, 
   3.678245209410329*^9}, {3.678353321104701*^9, 3.67835332153253*^9}, {
   3.717617373439599*^9, 3.717617381542782*^9}, {3.717618592815556*^9, 
   3.717618621954019*^9}, {3.71761969857882*^9, 3.717619698929061*^9}, {
   3.717628299773491*^9, 3.717628357895966*^9}, {3.717714583475328*^9, 
   3.717714584623209*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"818ffd26-1456-48a4-bca1-057b3ed0b812"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`ui$$ = 0.25, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`ui$$], {0.1, 0.25, 0.5, 1}}}, Typeset`size$$ = {
    360., {135., 139.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`ui$43951$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`ui$$ = 0.1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`ui$$, $CellContext`ui$43951$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`RsSingle$, $CellContext`RsDouble$}, \
$CellContext`RsSingle$ = Map[{
            Part[#, 1], 
            Part[
             Part[#, 4], 5, 2]}& , 
           Select[
           FlatlandhalfspaceAlbedoProblemIsotropic`simulationsdelta, 
            Part[#, 3] == $CellContext`ui$$& ]]; $CellContext`RsDouble$ = Map[{
            Part[#, 1], 
            Part[
             Part[#, 4], 5, 3]}& , 
           Select[
           FlatlandhalfspaceAlbedoProblemIsotropic`simulationsdelta, 
            Part[#, 3] == $CellContext`ui$$& ]]; $CellContext`pASS = Quiet[
           Show[
            Show[
             ListLogLinearPlot[$CellContext`RsSingle$, PlotStyle -> {
                PointSize[0.01], Black}], 
             ListLogLinearPlot[$CellContext`RsDouble$, PlotStyle -> {
                PointSize[0.01], Black}], 
             LogLinearPlot[
              Quiet[
               
               FlatlandhalfspaceAlbedoProblemIsotropic`\
albedoSingleScatterExact[$CellContext`c, $CellContext`ui$$]], {$CellContext`c,
                0.001, 0.9999}, PlotRange -> All, PlotStyle -> Dashed], 
             LogLinearPlot[
              Quiet[
               
               FlatlandhalfspaceAlbedoProblemIsotropic`\
albedoDoubleScatterExact[$CellContext`c, $CellContext`ui$$]], {$CellContext`c,
                0.001, 0.9999}, PlotRange -> All]], Frame -> True, 
            FrameLabel -> {{
               
               Subscript[$CellContext`R, \
$CellContext`n][$CellContext`\[Alpha], $CellContext`ui$$], Null}, {
              "Single scattering albedo: \[Alpha]", 
               StringJoin[
               "Single (Dashed) and Double-Scattered Reflectance/Albedo \
\!\(\*SubscriptBox[\(R\), \(n\)]\)(\[Alpha],\!\(\*SubscriptBox[\(u\), \
\(i\)]\)): \nisotropically-scattering half space\nincidence \
(\!\(\*SubscriptBox[\(u\), \(i\)]\)=", 
                ToString[$CellContext`ui$$], 
                "), indexed-matched boundary"]}}]]], 
      "Specifications" :> {{$CellContext`ui$$, {0.1, 0.25, 0.5, 1}}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{405., {178., 184.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.678244483749028*^9, {3.678244757623412*^9, 3.678244843497265*^9}, 
   3.678244876676355*^9, 3.678244970897399*^9, {3.678245179862151*^9, 
   3.678245209781083*^9}, 3.6783534640482407`*^9, 3.67976566553354*^9, 
   3.679778034467782*^9, 3.679780801432678*^9, 3.6803413069803743`*^9, 
   3.681349663928796*^9, 3.681349707290015*^9, 3.681880089659569*^9, 
   3.717617382048821*^9, 3.71761765218246*^9, {3.717618593736373*^9, 
   3.717618622615991*^9}, 3.7176196996440067`*^9, {3.7176283023398247`*^9, 
   3.7176283585564013`*^9}, 3.7177145856494617`*^9, 3.735095340536211*^9},
 CellLabel->"Out[57]=",ExpressionUUID->"786b631f-b79c-458e-bf89-c0d565dc5c85"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Emerging distribution - Diffuse illumination", "Subsection",
 CellChangeTimes->{{3.7525560174322567`*^9, 
  3.752556023168909*^9}},ExpressionUUID->"a3bdbdfb-223c-4464-b880-\
7d276aba9a1d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "emerging", ",", "imdata", ",", "sim", ",", "du", ",", "emergingS", ",",
        "emergingD", ",", "stride"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sim", "=", 
       RowBox[{"SelectFirst", "[", 
        RowBox[{
        "FlatlandhalfspaceAlbedoProblemIsotropic`simulationswhitesky", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}]}], "&"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imdata", "=", 
       RowBox[{"sim", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"du", "=", 
       RowBox[{"imdata", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "5"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"stride", "=", "3"}], ";", "\[IndentingNewLine]", 
      RowBox[{"emerging", "=", 
       RowBox[{
        RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints", "[", 
         RowBox[{
          RowBox[{"imdata", "[", 
           RowBox[{"[", "7", "]"}], "]"}], ",", "du"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", 
          RowBox[{"-", "1"}], ";;", "stride"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"emergingS", "=", 
       RowBox[{
        RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints", "[", 
         RowBox[{
          RowBox[{"imdata", "[", 
           RowBox[{"[", "9", "]"}], "]"}], ",", "du"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", 
          RowBox[{"-", "1"}], ";;", "stride"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"emergingD", "=", 
       RowBox[{
        RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints", "[", 
         RowBox[{
          RowBox[{"imdata", "[", 
           RowBox[{"[", "11", "]"}], "]"}], ",", "du"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", 
          RowBox[{"-", "1"}], ";;", "stride"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pBRDF", "=", 
       RowBox[{"Quiet", "[", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Show", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"u", " ", 
               RowBox[{"G", "[", 
                RowBox[{"u", ",", "2"}], "]"}], " ", 
               FractionBox["Pi", "2"], " ", 
               RowBox[{
               "FlatlandhalfspaceAlbedoProblemIsotropic`albedoexact", "[", 
                RowBox[{"\[Alpha]", ",", "u"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"u", ",", "0", ",", ".98"}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Thin"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"u", " ", 
               RowBox[{"G", "[", 
                RowBox[{"u", ",", "2"}], "]"}], " ", 
               FractionBox["Pi", "2"], " ", 
               RowBox[{
               "FlatlandhalfspaceAlbedoProblemIsotropic`\
albedoSingleScatterExact", "[", 
                RowBox[{"\[Alpha]", ",", "u"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"u", ",", "0", ",", ".998"}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Dashed"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"u", " ", 
               RowBox[{"G", "[", 
                RowBox[{"u", ",", "2"}], "]"}], " ", 
               FractionBox["Pi", "2"], " ", 
               RowBox[{
               "FlatlandhalfspaceAlbedoProblemIsotropic`\
albedoDoubleScatterExact", "[", 
                RowBox[{"\[Alpha]", ",", "u"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"u", ",", "0", ",", ".998"}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Thick"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"emerging", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", 
                 RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"PointSize", "[", "0.005", "]"}], ",", "Black"}], 
                "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"emergingS", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", 
                 RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"PointSize", "[", "0.005", "]"}], ",", "Black"}], 
                "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"emergingD", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", 
                 RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"PointSize", "[", "0.005", "]"}], ",", "Black"}], 
                "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<I\>\"", "[", 
                RowBox[{"0", ",", "\[Mu]"}], "]"}], ","}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["\[Mu]", "o"], ",", 
               "\"\<Emerging Distribution Diffuse illumination\>\""}], 
              "}"}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}], 
        "\[IndentingNewLine]", "]"}]}]}]}], "]"}], "\[IndentingNewLine]", ",",
    "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "0.8"}], "}"}], ",", 
     "FlatlandhalfspaceAlbedoProblemIsotropic`alphas"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.75255547162889*^9, 3.752555507075822*^9}, {
  3.7525555519026213`*^9, 3.752555600265058*^9}, {3.752555671611416*^9, 
  3.752555675498226*^9}, {3.752555709250142*^9, 3.7525557631710443`*^9}, {
  3.752555826604344*^9, 3.7525559099341717`*^9}, {3.752555995222172*^9, 
  3.7525559959988747`*^9}, {3.7618464311168413`*^9, 3.761846495933935*^9}, {
  3.761846584373292*^9, 3.761846591430121*^9}},
 CellLabel->
  "In[872]:=",ExpressionUUID->"deb776fb-b6e7-4079-9b01-a463352f2c2d"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`\[Alpha]$$ = 0.7, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`\[Alpha]$$], 0.8}, {0.01, 0.1, 0.3, 0.5, 0.7, 0.8, 
      0.9, 0.95, 0.99, 0.999}}}, Typeset`size$$ = {500., {164., 168.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`\[Alpha]$4731252$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`\[Alpha]$$ = 0.8}, 
      "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$4731252$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`emerging$, $CellContext`imdata$, \
$CellContext`sim$, $CellContext`du$, $CellContext`emergingS$, \
$CellContext`emergingD$, $CellContext`stride$}, $CellContext`sim$ = 
         SelectFirst[
          FlatlandhalfspaceAlbedoProblemIsotropic`simulationswhitesky, And[
           Part[#, 1] == $CellContext`\[Alpha]$$, Part[#, 2] == 
            1]& ]; $CellContext`imdata$ = 
         Part[$CellContext`sim$, 3]; $CellContext`du$ = 
         Part[$CellContext`imdata$, 2, 5]; $CellContext`stride$ = 
         3; $CellContext`emerging$ = Part[
           FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints[
            Part[$CellContext`imdata$, 7], $CellContext`du$], 
           Span[1, -1, $CellContext`stride$]]; $CellContext`emergingS$ = 
         Part[
           FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints[
            Part[$CellContext`imdata$, 9], $CellContext`du$], 
           Span[1, -1, $CellContext`stride$]]; $CellContext`emergingD$ = 
         Part[
           FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints[
            Part[$CellContext`imdata$, 11], $CellContext`du$], 
           Span[1, -1, $CellContext`stride$]]; $CellContext`pBRDF = Quiet[
           Show[
            Show[
             
             Plot[$CellContext`u $CellContext`G[$CellContext`u, 2] (Pi/2) 
              FlatlandhalfspaceAlbedoProblemIsotropic`albedoexact[$\
CellContext`\[Alpha]$$, $CellContext`u], {$CellContext`u, 0, 0.98}, PlotRange -> 
              All, PlotStyle -> Thin], 
             
             Plot[$CellContext`u $CellContext`G[$CellContext`u, 2] (Pi/2) 
              FlatlandhalfspaceAlbedoProblemIsotropic`\
albedoSingleScatterExact[$CellContext`\[Alpha]$$, $CellContext`u], \
{$CellContext`u, 0, 0.998}, PlotStyle -> Dashed], 
             
             Plot[$CellContext`u $CellContext`G[$CellContext`u, 2] (Pi/2) 
              FlatlandhalfspaceAlbedoProblemIsotropic`\
albedoDoubleScatterExact[$CellContext`\[Alpha]$$, $CellContext`u], \
{$CellContext`u, 0, 0.998}, PlotStyle -> Thick], 
             ListPlot[
              Part[$CellContext`emerging$, 
               Span[1, -2]], PlotStyle -> {
                PointSize[0.005], Black}], 
             ListPlot[
              Part[$CellContext`emergingS$, 
               Span[1, -2]], PlotStyle -> {
                PointSize[0.005], Black}], 
             ListPlot[
              Part[$CellContext`emergingD$, 
               Span[1, -2]], PlotStyle -> {
                PointSize[0.005], Black}]], Frame -> True, ImageSize -> 500, 
            FrameLabel -> {{
               "I"[0, $CellContext`\[Mu]], Null}, {
               Subscript[$CellContext`\[Mu], $CellContext`o], 
               "Emerging Distribution Diffuse illumination"}}]]], 
      "Specifications" :> {{{$CellContext`\[Alpha]$$, 0.8}, {0.01, 0.1, 0.3, 
         0.5, 0.7, 0.8, 0.9, 0.95, 0.99, 0.999}}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{545., {208., 214.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.7525555099100723`*^9, {3.752555558062381*^9, 3.7525556006536913`*^9}, 
   3.752555677904561*^9, {3.752555714472625*^9, 3.752555763413569*^9}, {
   3.7525558340988503`*^9, 3.752555873876732*^9}, 3.7525559134588118`*^9, {
   3.7618464322100983`*^9, 3.7618464963170013`*^9}, 3.761846591835393*^9},
 CellLabel->
  "Out[872]=",ExpressionUUID->"2d34bbfe-db5e-48ed-b486-885a45581098"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "emerging", ",", "imdata", ",", "sim", ",", "du", ",", "emergingS", ",",
        "emergingD", ",", "stride"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sim", "=", 
       RowBox[{"SelectFirst", "[", 
        RowBox[{
        "FlatlandhalfspaceAlbedoProblemIsotropic`simulationswhitesky", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}]}], "&"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imdata", "=", 
       RowBox[{"sim", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"du", "=", 
       RowBox[{"imdata", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "5"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"stride", "=", "3"}], ";", "\[IndentingNewLine]", 
      RowBox[{"emerging", "=", 
       RowBox[{
        RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints", "[", 
         RowBox[{
          RowBox[{"imdata", "[", 
           RowBox[{"[", "7", "]"}], "]"}], ",", "du"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", 
          RowBox[{"-", "1"}], ";;", "stride"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"emergingS", "=", 
       RowBox[{
        RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints", "[", 
         RowBox[{
          RowBox[{"imdata", "[", 
           RowBox[{"[", "9", "]"}], "]"}], ",", "du"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", 
          RowBox[{"-", "1"}], ";;", "stride"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"emergingD", "=", 
       RowBox[{
        RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints", "[", 
         RowBox[{
          RowBox[{"imdata", "[", 
           RowBox[{"[", "11", "]"}], "]"}], ",", "du"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", 
          RowBox[{"-", "1"}], ";;", "stride"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pBRDF", "=", 
       RowBox[{"Quiet", "[", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Show", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Plot", "[", " ", 
             RowBox[{
              RowBox[{"u", " ", 
               RowBox[{"G", "[", 
                RowBox[{"u", ",", "2"}], "]"}], " ", 
               FractionBox["Pi", "2"], " ", 
               RowBox[{
               "FlatlandhalfspaceAlbedoProblemIsotropic`albedoexact", "[", 
                RowBox[{"\[Alpha]", ",", "u"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"u", ",", "0", ",", ".998"}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Thin"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Plot", "[", " ", 
             RowBox[{
              RowBox[{"u", " ", 
               RowBox[{"G", "[", 
                RowBox[{"u", ",", "2"}], "]"}], " ", 
               FractionBox["Pi", "2"], " ", 
               RowBox[{
               "FlatlandhalfspaceAlbedoProblemIsotropic`\
albedoSingleScatterExact", "[", 
                RowBox[{"\[Alpha]", ",", "u"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"u", ",", "0", ",", ".998"}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Dashed"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"u", " ", 
               RowBox[{"G", "[", 
                RowBox[{"u", ",", "2"}], "]"}], " ", 
               FractionBox["Pi", "2"], " ", 
               RowBox[{
               "FlatlandhalfspaceAlbedoProblemIsotropic`\
albedoDoubleScatterExact", "[", 
                RowBox[{"\[Alpha]", ",", "u"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"u", ",", "0", ",", ".998"}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Thick"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"emerging", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", 
                 RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"PointSize", "[", "0.005", "]"}], ",", "Black"}], 
                "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"emergingS", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", 
                 RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"PointSize", "[", "0.005", "]"}], ",", "Black"}], 
                "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"emergingD", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", 
                 RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"PointSize", "[", "0.005", "]"}], ",", "Black"}], 
                "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<I\>\"", "[", 
                RowBox[{"0", ",", "\[Mu]"}], "]"}], ","}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["\[Mu]", "o"], ",", 
               "\"\<Emerging Distribution Diffuse illumination\>\""}], 
              "}"}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}], 
        "\[IndentingNewLine]", "]"}]}]}]}], "]"}], "\[IndentingNewLine]", ",",
    "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "0.8"}], "}"}], ",", 
     "FlatlandhalfspaceAlbedoProblemIsotropic`alphas"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.75255547162889*^9, 3.752555507075822*^9}, {
  3.7525555519026213`*^9, 3.752555600265058*^9}, {3.752555671611416*^9, 
  3.752555675498226*^9}, {3.752555709250142*^9, 3.7525557631710443`*^9}, {
  3.752555826604344*^9, 3.7525559099341717`*^9}, {3.752555995222172*^9, 
  3.7525559959988747`*^9}, {3.752556138711507*^9, 3.752556187182322*^9}},
 CellLabel->
  "In[1093]:=",ExpressionUUID->"f43fbd4d-1227-4f2f-9fe6-f8c70577586c"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`\[Alpha]$$ = 0.8, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`\[Alpha]$$], 0.8}, {0.01, 0.1, 0.3, 0.5, 0.7, 0.8, 
      0.9, 0.95, 0.99, 0.999}}}, Typeset`size$$ = {500., {166., 171.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`\[Alpha]$8578189$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`\[Alpha]$$ = 0.8}, 
      "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$8578189$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`emerging$, $CellContext`imdata$, \
$CellContext`sim$, $CellContext`du$, $CellContext`emergingS$, \
$CellContext`emergingD$, $CellContext`stride$}, $CellContext`sim$ = 
         SelectFirst[
          FlatlandhalfspaceAlbedoProblemIsotropic`simulationswhitesky, And[
           Part[#, 1] == $CellContext`\[Alpha]$$, Part[#, 2] == 
            1]& ]; $CellContext`imdata$ = 
         Part[$CellContext`sim$, 3]; $CellContext`du$ = 
         Part[$CellContext`imdata$, 2, 5]; $CellContext`stride$ = 
         3; $CellContext`emerging$ = Part[
           FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints[
            Part[$CellContext`imdata$, 7], $CellContext`du$], 
           Span[1, -1, $CellContext`stride$]]; $CellContext`emergingS$ = 
         Part[
           FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints[
            Part[$CellContext`imdata$, 9], $CellContext`du$], 
           Span[1, -1, $CellContext`stride$]]; $CellContext`emergingD$ = 
         Part[
           FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints[
            Part[$CellContext`imdata$, 11], $CellContext`du$], 
           Span[1, -1, $CellContext`stride$]]; $CellContext`pBRDF = Quiet[
           Show[
            Show[
             
             Plot[(($CellContext`u $CellContext`G[$CellContext`u, 2]) (Pi/2)) 
              FlatlandhalfspaceAlbedoProblemIsotropic`albedoexact[$\
CellContext`\[Alpha]$$, $CellContext`u], {$CellContext`u, 0, 0.998}, 
              PlotRange -> All, PlotStyle -> Thin], 
             
             Plot[(($CellContext`u $CellContext`G[$CellContext`u, 2]) (Pi/2)) 
              FlatlandhalfspaceAlbedoProblemIsotropic`\
albedoSingleScatterExact[$CellContext`\[Alpha]$$, $CellContext`u], \
{$CellContext`u, 0, 0.998}, PlotStyle -> Dashed], 
             
             Plot[(($CellContext`u $CellContext`G[$CellContext`u, 2]) (Pi/2)) 
              FlatlandhalfspaceAlbedoProblemIsotropic`\
albedoDoubleScatterExact[$CellContext`\[Alpha]$$, $CellContext`u], \
{$CellContext`u, 0, 0.998}, PlotStyle -> Thick], 
             ListPlot[
              Part[$CellContext`emerging$, 
               Span[1, -2]], PlotStyle -> {
                PointSize[0.005], Black}], 
             ListPlot[
              Part[$CellContext`emergingS$, 
               Span[1, -2]], PlotStyle -> {
                PointSize[0.005], Black}], 
             ListPlot[
              Part[$CellContext`emergingD$, 
               Span[1, -2]], PlotStyle -> {
                PointSize[0.005], Black}]], Frame -> True, ImageSize -> 500, 
            FrameLabel -> {{
               "I"[0, $CellContext`\[Mu]], Null}, {
               Subscript[$CellContext`\[Mu], $CellContext`o], 
               "Emerging Distribution Diffuse illumination"}}]]], 
      "Specifications" :> {{{$CellContext`\[Alpha]$$, 0.8}, {0.01, 0.1, 0.3, 
         0.5, 0.7, 0.8, 0.9, 0.95, 0.99, 0.999}}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{545., {211., 217.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.752556146545751*^9, 3.752556187721881*^9}},
 CellLabel->
  "Out[1093]=",ExpressionUUID->"37da81ad-3957-48f2-a2ca-77b82710abdd"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["BRDF Benchmarks", "Section",
 CellChangeTimes->{{3.678323983318059*^9, 
  3.678323986029189*^9}},ExpressionUUID->"7f69b1d9-93d6-4d10-afa6-\
4080981e44e7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "emerging", ",", "imdata", ",", "sim", ",", "du", ",", "emergingS", ",",
        "emergingD", ",", "stride"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sim", "=", 
       RowBox[{"SelectFirst", "[", 
        RowBox[{
        "FlatlandhalfspaceAlbedoProblemIsotropic`simulationsdelta", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "ui"}], "&&", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}]}], "&"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imdata", "=", 
       RowBox[{"sim", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"du", "=", 
       RowBox[{"imdata", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "5"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"stride", "=", "3"}], ";", "\[IndentingNewLine]", 
      RowBox[{"emerging", "=", 
       RowBox[{
        RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints2", "[", 
         RowBox[{
          RowBox[{"imdata", "[", 
           RowBox[{"[", "7", "]"}], "]"}], ",", "du"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", 
          RowBox[{"-", "1"}], ";;", "stride"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"emergingS", "=", 
       RowBox[{
        RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints2", "[", 
         RowBox[{
          RowBox[{"imdata", "[", 
           RowBox[{"[", "9", "]"}], "]"}], ",", "du"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", 
          RowBox[{"-", "1"}], ";;", "stride"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"emergingD", "=", 
       RowBox[{
        RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints2", "[", 
         RowBox[{
          RowBox[{"imdata", "[", 
           RowBox[{"[", "11", "]"}], "]"}], ",", "du"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", 
          RowBox[{"-", "1"}], ";;", "stride"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pBRDF", "=", 
       RowBox[{"Quiet", "[", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Show", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Plot", "[", " ", 
             RowBox[{
              RowBox[{"u", "  ", 
               RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`BRDF", "[", 
                RowBox[{"\[Alpha]", ",", "ui", ",", "u"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"u", ",", "0", ",", ".998"}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Thin"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Plot", "[", " ", 
             RowBox[{
              RowBox[{"u", " ", 
               RowBox[{
               "FlatlandhalfspaceAlbedoProblemIsotropic`BRDFsinglescatter", 
                "[", 
                RowBox[{"\[Alpha]", ",", "ui", ",", "u"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"u", ",", "0", ",", ".998"}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Dashed"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Plot", "[", " ", 
             RowBox[{
              RowBox[{"u", " ", 
               RowBox[{
               "FlatlandhalfspaceAlbedoProblemIsotropic`BRDFdoublescatter", 
                "[", 
                RowBox[{"\[Alpha]", ",", "ui", ",", "u"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"u", ",", "0", ",", ".998"}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Thick"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"emerging", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", 
                 RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"PointSize", "[", "0.005", "]"}], ",", "Black"}], 
                "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"emergingS", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", 
                 RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"PointSize", "[", "0.005", "]"}], ",", "Black"}], 
                "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"emergingD", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", 
                 RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"PointSize", "[", "0.005", "]"}], ",", "Black"}], 
                "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[Mu]", "o"], 
                RowBox[{
                 SubscriptBox["f", "r"], "[", 
                 RowBox[{
                  SubscriptBox["\[Mu]", "i"], ",", 
                  SubscriptBox["\[Mu]", "o"]}], "]"}]}], ","}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["\[Mu]", "o"], ",", 
               RowBox[{
               "\"\<Emerging Distribution \!\(\*SubscriptBox[\(f\), \(r\)]\)(\
\!\(\*SubscriptBox[\(\[Mu]\), \(i\)]\),\!\(\*SubscriptBox[\(\[Mu]\), \
\(o\)]\)): isotropically-scattering half space\\nincidence \
(\!\(\*SubscriptBox[\(\[Mu]\), \(i\)]\)=\>\"", "<>", 
                RowBox[{"ToString", "[", "ui", "]"}], "<>", 
                "\"\<), indexed-matched boundary\\nTotal (thin), \
Single-Scatter (dashed), Double-scatter (thick)\>\""}]}], "}"}]}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}]}]}], 
    "]"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "0.8"}], "}"}], ",", 
     "FlatlandhalfspaceAlbedoProblemIsotropic`alphas"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ui", ",", "0.25"}], "}"}], ",", 
     "FlatlandhalfspaceAlbedoProblemIsotropic`uis"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.717602195534525*^9, 3.717602224350956*^9}, {
  3.717602666153323*^9, 3.7176026795772676`*^9}, {3.717602718114685*^9, 
  3.717602733991729*^9}, {3.717603038660512*^9, 3.717603080689616*^9}, {
  3.717603144516736*^9, 3.717603206979807*^9}, {3.717603347752123*^9, 
  3.7176033572220697`*^9}, {3.717603411429098*^9, 3.717603416312931*^9}, {
  3.717603540355929*^9, 3.717603574825264*^9}, {3.717603646611464*^9, 
  3.717603651395254*^9}, {3.71760369256398*^9, 3.717603704899254*^9}, {
  3.717605915805434*^9, 3.717605920517454*^9}, {3.717628486602413*^9, 
  3.7176284878091993`*^9}, {3.725825146840355*^9, 3.725825191586173*^9}, {
  3.72582535425672*^9, 3.725825385453825*^9}, {3.725825510208805*^9, 
  3.725825514057488*^9}},
 CellLabel->
  "In[760]:=",ExpressionUUID->"3b68d7d5-c975-472d-836f-aa1534d32983"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`ui$$ = 0.25, $CellContext`\[Alpha]$$ = 0.8, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`\[Alpha]$$], 0.8}, {0.01, 0.1, 0.3, 0.5, 0.7, 0.8, 
      0.9, 0.95, 0.99, 0.999}}, {{
       Hold[$CellContext`ui$$], 0.25}, {0.1, 0.25, 0.5, 1}}}, 
    Typeset`size$$ = {500., {178., 182.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`\[Alpha]$4391540$$ = 0, $CellContext`ui$4391541$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`ui$$ = 0.25, $CellContext`\[Alpha]$$ = 
        0.8}, "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$4391540$$, 0], 
        Hold[$CellContext`ui$$, $CellContext`ui$4391541$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`emerging$, $CellContext`imdata$, \
$CellContext`sim$, $CellContext`du$, $CellContext`emergingS$, \
$CellContext`emergingD$, $CellContext`stride$}, $CellContext`sim$ = 
         SelectFirst[
          FlatlandhalfspaceAlbedoProblemIsotropic`simulationsdelta, And[
           Part[#, 3] == $CellContext`ui$$, 
            Part[#, 1] == $CellContext`\[Alpha]$$, Part[#, 2] == 
            1]& ]; $CellContext`imdata$ = 
         Part[$CellContext`sim$, 4]; $CellContext`du$ = 
         Part[$CellContext`imdata$, 2, 5]; $CellContext`stride$ = 
         3; $CellContext`emerging$ = Part[
           FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints2[
            Part[$CellContext`imdata$, 7], $CellContext`du$], 
           Span[1, -1, $CellContext`stride$]]; $CellContext`emergingS$ = 
         Part[
           FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints2[
            Part[$CellContext`imdata$, 9], $CellContext`du$], 
           Span[1, -1, $CellContext`stride$]]; $CellContext`emergingD$ = 
         Part[
           FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints2[
            Part[$CellContext`imdata$, 11], $CellContext`du$], 
           Span[1, -1, $CellContext`stride$]]; $CellContext`pBRDF = Quiet[
           Show[
            Show[
             
             Plot[$CellContext`u 
              FlatlandhalfspaceAlbedoProblemIsotropic`BRDF[$CellContext`\
\[Alpha]$$, $CellContext`ui$$, $CellContext`u], {$CellContext`u, 0, 0.998}, 
              PlotRange -> All, PlotStyle -> Thin], 
             
             Plot[$CellContext`u 
              FlatlandhalfspaceAlbedoProblemIsotropic`BRDFsinglescatter[$\
CellContext`\[Alpha]$$, $CellContext`ui$$, $CellContext`u], {$CellContext`u, 
               0, 0.998}, PlotStyle -> Dashed], 
             
             Plot[$CellContext`u 
              FlatlandhalfspaceAlbedoProblemIsotropic`BRDFdoublescatter[$\
CellContext`\[Alpha]$$, $CellContext`ui$$, $CellContext`u], {$CellContext`u, 
               0, 0.998}, PlotStyle -> Thick], 
             ListPlot[
              Part[$CellContext`emerging$, 
               Span[1, -2]], PlotStyle -> {
                PointSize[0.005], Black}], 
             ListPlot[
              Part[$CellContext`emergingS$, 
               Span[1, -2]], PlotStyle -> {
                PointSize[0.005], Black}], 
             ListPlot[
              Part[$CellContext`emergingD$, 
               Span[1, -2]], PlotStyle -> {
                PointSize[0.005], Black}]], Frame -> True, ImageSize -> 500, 
            FrameLabel -> {{
              Subscript[$CellContext`\[Mu], $CellContext`o] 
               Subscript[$CellContext`f, $CellContext`r][
                 Subscript[$CellContext`\[Mu], $CellContext`i], 
                 Subscript[$CellContext`\[Mu], $CellContext`o]], Null}, {
               Subscript[$CellContext`\[Mu], $CellContext`o], 
               StringJoin[
               "Emerging Distribution \!\(\*SubscriptBox[\(f\), \(r\)]\)(\!\(\
\*SubscriptBox[\(\[Mu]\), \(i\)]\),\!\(\*SubscriptBox[\(\[Mu]\), \(o\)]\)): \
isotropically-scattering half space\nincidence (\!\(\*SubscriptBox[\(\[Mu]\), \
\(i\)]\)=", 
                ToString[$CellContext`ui$$], 
                "), indexed-matched boundary\nTotal (thin), Single-Scatter \
(dashed), Double-scatter (thick)"]}}]]], 
      "Specifications" :> {{{$CellContext`\[Alpha]$$, 0.8}, {0.01, 0.1, 0.3, 
         0.5, 0.7, 0.8, 0.9, 0.95, 0.99, 
         0.999}}, {{$CellContext`ui$$, 0.25}, {0.1, 0.25, 0.5, 1}}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{545., {235., 241.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.717602227907249*^9, 3.717602294871874*^9, 3.71760268018475*^9, {
   3.717602719044866*^9, 3.717602734934475*^9}, {3.717603041613059*^9, 
   3.717603081354022*^9}, 3.717603146418852*^9, {3.717603182396673*^9, 
   3.717603207716135*^9}, 3.717603357699246*^9, 3.717603416709773*^9, {
   3.717603548502035*^9, 3.717603575237558*^9}, 3.717603652534885*^9, 
   3.71760370554117*^9, 3.717605920966241*^9, 3.717628488554365*^9, 
   3.7258251090021067`*^9, 3.725825148392934*^9, 3.725825192348898*^9, {
   3.725825360055045*^9, 3.7258253859790983`*^9}, 3.7258255150182943`*^9, 
   3.7350954259435062`*^9, 3.761778729628072*^9},
 CellLabel->
  "Out[760]=",ExpressionUUID->"da67ab5a-2ece-4bd8-96ee-1b7f7abd3c68"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\</Users/eug/Documents/research/transport/papers/flatlandttsp/img/pBRDF.\
pdf\>\"", ",", "pBRDF"}], "]"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moments", "Section",
 CellChangeTimes->{{3.7342796939838743`*^9, 
  3.734279694645108*^9}},ExpressionUUID->"b4b13f96-0592-485f-b9c5-\
359b0e23ce9d"],

Cell[CellGroupData[{

Cell["Angular Moments of Exitant Radiance - Delta Illumination", "Subsection",
 CellChangeTimes->{{3.681362744916136*^9, 
  3.681362757513769*^9}},ExpressionUUID->"da72d9a3-3b27-4862-b272-\
7b3dd69f6e20"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "imdata", ",", "sim", ",", "dz", ",", "maxz", ",", "fluence3", ",", 
        "fluence", ",", "stride", ",", "numzs"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sim", "=", 
        RowBox[{"SelectFirst", "[", 
         RowBox[{
         "FlatlandhalfspaceAlbedoProblemIsotropic`simulationsdelta", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "ui"}], "&&", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
            
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
             "\[CapitalSigma]t"}]}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"imdata", "=", 
        RowBox[{"sim", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"TableForm", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "\"\<MC:\>\"", "}"}], ",", 
            RowBox[{
             RowBox[{"imdata", "[", 
              RowBox[{"[", "17", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "\"\<Analytic:\>\"", "}"}], ",", 
            RowBox[{
            "FlatlandhalfspaceAlbedoProblemIsotropic`angularMmoments", "[", 
             RowBox[{"\[Alpha]", ",", "ui", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`H", "[", 
                RowBox[{"\[Alpha]", ",", "#"}], "]"}], "&"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`Hmoment", "[", 
                RowBox[{"\[Alpha]", ",", "#"}], "]"}], "&"}]}], 
             "\[IndentingNewLine]", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
         "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Alpha]", ",", "0.99"}], "}"}], ",", 
      "FlatlandhalfspaceAlbedoProblemIsotropic`alphas"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ui", ",", "0.5"}], "}"}], ",", 
      "FlatlandhalfspaceAlbedoProblemIsotropic`uis"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
     "\[CapitalSigma]t", ",", 
      "FlatlandhalfspaceAlbedoProblemIsotropic`muts"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.678243714363831*^9, 3.678243802473928*^9}, {
   3.6782438372745743`*^9, 3.678243918405334*^9}, {3.678244848477655*^9, 
   3.678244871652142*^9}, 3.678244974528975*^9, {3.6783812459205103`*^9, 
   3.678381252573442*^9}, {3.678381299886239*^9, 3.678381302440772*^9}, {
   3.678381482937087*^9, 3.67838152124067*^9}, {3.6783816672515917`*^9, 
   3.678381901224969*^9}, {3.6783819833752737`*^9, 3.678381984893968*^9}, {
   3.678382028434991*^9, 3.678382051113124*^9}, {3.678382476562173*^9, 
   3.678382531616342*^9}, {3.6783825770739527`*^9, 3.6783826434825163`*^9}, {
   3.678382818564744*^9, 3.678382822589374*^9}, {3.6783830180371923`*^9, 
   3.678383070242436*^9}, {3.678383105394609*^9, 3.678383124360643*^9}, {
   3.67838317595117*^9, 3.678383188135069*^9}, {3.678383240059972*^9, 
   3.678383266639002*^9}, {3.6783833301136513`*^9, 3.678383335323216*^9}, {
   3.6783833670062733`*^9, 3.678383463817894*^9}, {3.678383521513876*^9, 
   3.6783835456193733`*^9}, {3.678386332154438*^9, 3.678386560606522*^9}, {
   3.678465505399572*^9, 3.678465538006304*^9}, {3.678465595345571*^9, 
   3.678465657415832*^9}, {3.6784788259692574`*^9, 3.678478861255927*^9}, {
   3.6784790017886677`*^9, 3.6784790764906883`*^9}, {3.67847912413452*^9, 
   3.6784791297973347`*^9}, {3.6790108325055857`*^9, 3.679010850916103*^9}, {
   3.679011009036701*^9, 3.679011009308338*^9}, 3.6790112868995256`*^9, {
   3.67902348087889*^9, 3.679023481708637*^9}, 3.679023648763858*^9, 
   3.679023893722725*^9, {3.679024040083886*^9, 3.679024042826344*^9}, {
   3.679778319713251*^9, 3.679778326542061*^9}, {3.679780908227364*^9, 
   3.679780910009165*^9}, {3.6813503292376842`*^9, 3.681350329548441*^9}, {
   3.681350617607449*^9, 3.681350619603817*^9}, {3.681350840373707*^9, 
   3.681350840788444*^9}, {3.681362776836555*^9, 3.6813628077201557`*^9}, {
   3.681362842217553*^9, 3.68136284556667*^9}, {3.681363064573875*^9, 
   3.681363144688005*^9}, {3.681363178487775*^9, 3.6813631786146297`*^9}, {
   3.681363377486508*^9, 3.681363377692432*^9}, {3.681534387287829*^9, 
   3.6815344304136887`*^9}, {3.681534480790941*^9, 3.681534485677236*^9}, {
   3.6815345393565617`*^9, 3.6815345401159286`*^9}, 3.681880007034378*^9, {
   3.6818802756397047`*^9, 3.681880278024098*^9}, {3.734279704020913*^9, 
   3.734279711494433*^9}, {3.734279814190919*^9, 3.734279815152396*^9}},
 CellLabel->
  "In[327]:=",ExpressionUUID->"422df7dc-53c4-4f0f-9b22-8cd735930d9a"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`ui$$ = 0.5, $CellContext`\[Alpha]$$ = 
    0.9, $CellContext`\[CapitalSigma]t$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`\[Alpha]$$], 0.99}, {0.01, 0.1, 0.3, 0.5, 0.7, 0.8, 
      0.9, 0.95, 0.99, 0.999}}, {{
       Hold[$CellContext`ui$$], 0.5}, {0.1, 0.25, 0.5, 1}}, {
      Hold[$CellContext`\[CapitalSigma]t$$], {1}}}, Typeset`size$$ = {
    337., {12.134033203125, 17.865966796875}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`\[Alpha]$6274088$$ = 0, $CellContext`ui$6274089$$ = 
    0, $CellContext`\[CapitalSigma]t$6274090$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`ui$$ = 0.5, $CellContext`\[Alpha]$$ = 
        0.99, $CellContext`\[CapitalSigma]t$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$6274088$$, 0], 
        Hold[$CellContext`ui$$, $CellContext`ui$6274089$$, 0], 
        Hold[$CellContext`\[CapitalSigma]t$$, \
$CellContext`\[CapitalSigma]t$6274090$$, False]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`imdata$, $CellContext`sim$, $CellContext`dz$, \
$CellContext`maxz$, $CellContext`fluence3$, $CellContext`fluence$, \
$CellContext`stride$, $CellContext`numzs$}, $CellContext`sim$ = 
         SelectFirst[
          FlatlandhalfspaceAlbedoProblemIsotropic`simulationsdelta, And[
           Part[#, 3] == $CellContext`ui$$, 
            Part[#, 1] == $CellContext`\[Alpha]$$, 
            Part[#, 2] == $CellContext`\[CapitalSigma]t$$]& ]; \
$CellContext`imdata$ = Part[$CellContext`sim$, 4]; TableForm[{
           Join[{"MC:"}, 
            Part[
             Part[$CellContext`imdata$, 17], 
             Span[1, 3]]], 
           Join[{"Analytic:"}, 
            
            FlatlandhalfspaceAlbedoProblemIsotropic`angularMmoments[$\
CellContext`\[Alpha]$$, $CellContext`ui$$, 
             FlatlandhalfspaceAlbedoProblemIsotropic`H[$CellContext`\[Alpha]$$\
, #]& , FlatlandhalfspaceAlbedoProblemIsotropic`Hmoment[$CellContext`\[Alpha]$\
$, #]& ]]}]], 
      "Specifications" :> {{{$CellContext`\[Alpha]$$, 0.99}, {0.01, 0.1, 0.3, 
         0.5, 0.7, 0.8, 0.9, 0.95, 0.99, 0.999}}, {{$CellContext`ui$$, 0.5}, {
         0.1, 0.25, 0.5, 1}}, {$CellContext`\[CapitalSigma]t$$, {1}}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{382., {84., 90.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.681880279712525*^9, 3.73427971192728*^9, {3.7342797887802677`*^9, 
   3.734279815520514*^9}, 3.735095447479168*^9, 3.73509550273532*^9, 
   3.7350956472409697`*^9, 3.735151129220892*^9, 3.7353191814280148`*^9},
 CellLabel->
  "Out[327]=",ExpressionUUID->"99e47d7f-df6a-4b26-b05c-c46e199ea1a2"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.99`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,344,206,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735319793985258*^9},
 CellLabel->"",ExpressionUUID->"24db62cb-84ef-4efc-9db6-2f9ebc4e2b70"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.99`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,344,207,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735319794021468*^9},
 CellLabel->"",ExpressionUUID->"5e1d61b3-187e-4cc2-803c-e8f2b4b89fd4"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.99`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,344,208,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7353197940411997`*^9},
 CellLabel->"",ExpressionUUID->"d1343144-3bc7-4390-952e-199475f1fedc"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \
\\\"::\\\", \\\"inumr\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,344,209,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735319794060951*^9},
 CellLabel->"",ExpressionUUID->"16093454-1ba8-4532-a54b-6c53fb7e4f74"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.5`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,345,222,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735319857834656*^9},
 CellLabel->"",ExpressionUUID->"4d0e1b78-d298-4bd7-bf37-3380166d509c"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.5`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,345,223,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735319857856039*^9},
 CellLabel->"",ExpressionUUID->"4dd196a3-5fb3-4e49-b1a3-d77f3e494b0c"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.5`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,345,224,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735319857877797*^9},
 CellLabel->"",ExpressionUUID->"89a8f82f-b3d1-4c80-a8f9-8505bf5d4db1"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \
\\\"::\\\", \\\"inumr\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,345,225,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7353198578990297`*^9},
 CellLabel->"",ExpressionUUID->"0852f5f0-f0a7-4415-8ea5-655897eb5574"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.1`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,345,226,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7353198672054996`*^9},
 CellLabel->"",ExpressionUUID->"25281041-21ad-429c-a500-a59ea4979589"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.1`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,345,227,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735319867227117*^9},
 CellLabel->"",ExpressionUUID->"0426faa6-817f-4a47-8aae-448298a3fc32"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.1`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,345,228,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735319867252161*^9},
 CellLabel->"",ExpressionUUID->"f64952e1-4294-494e-ae62-eb6934d3005c"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \
\\\"::\\\", \\\"inumr\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,345,229,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7353198672757998`*^9},
 CellLabel->"",ExpressionUUID->"8db1e52e-cc82-4f29-b93f-f500eb77d659"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.9`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,345,230,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735319876625023*^9},
 CellLabel->"",ExpressionUUID->"c15abc82-65a4-49f3-9979-86582a936960"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.9`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,345,231,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7353198766465178`*^9},
 CellLabel->"",ExpressionUUID->"d0539625-6f05-416b-8df8-17b2cd65382c"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.9`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,345,232,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735319876668089*^9},
 CellLabel->"",ExpressionUUID->"ec848015-3020-4ac9-9fa7-9ce407c5ff68"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \
\\\"::\\\", \\\"inumr\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,345,233,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735319876689295*^9},
 CellLabel->"",ExpressionUUID->"11061bd4-2af5-4c57-9dd9-c5d77e6ade8d"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.9`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,348,248,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735320194511776*^9},
 CellLabel->"",ExpressionUUID->"109d5911-c85f-4270-8562-ccb6006d6f9b"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.9`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,348,249,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735320194544167*^9},
 CellLabel->"",ExpressionUUID->"5685aa7f-4a41-4a2b-9b91-76ff02621bb5"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.9`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,348,250,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735320194563031*^9},
 CellLabel->"",ExpressionUUID->"7a82c57f-35d6-491f-bf95-f98c5b59ca1e"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \
\\\"::\\\", \\\"inumr\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,348,251,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735320194581954*^9},
 CellLabel->"",ExpressionUUID->"90b3ca22-8ff8-4f5c-8a11-79d6bf746782"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.9`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,68,5,26006911133875019271,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.736484940029374*^9},
 CellLabel->"",ExpressionUUID->"94facfb3-62b7-46b0-aa05-e7ee0bab3b8a"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.9`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,68,6,26006911133875019271,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.736484940062241*^9},
 CellLabel->"",ExpressionUUID->"f75ab746-8025-44b6-93f6-f08a9a824ec7"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.9`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,68,7,26006911133875019271,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.736484940080579*^9},
 CellLabel->"",ExpressionUUID->"54278261-5221-4972-b800-37d7164b172c"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \
\\\"::\\\", \\\"inumr\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,68,8,26006911133875019271,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.73648494009933*^9},
 CellLabel->"",ExpressionUUID->"6fb9199d-fd40-4da4-85da-374b4ce87bdf"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Angular Moments of Exitant Radiance - White-Sky", "Subsection",
 CellChangeTimes->{{3.681362744916136*^9, 3.681362757513769*^9}, {
  3.681363495943247*^9, 
  3.681363497149448*^9}},ExpressionUUID->"9dd5d47a-5b3e-48a7-9212-\
fe927adaa3ce"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "imdata", ",", "sim", ",", "dz", ",", "maxz", ",", "fluence3", ",", 
        "fluence", ",", "stride", ",", "numzs"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sim", "=", 
        RowBox[{"SelectFirst", "[", 
         RowBox[{
         "FlatlandhalfspaceAlbedoProblemIsotropic`simulationswhitesky", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
            
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
             "\[CapitalSigma]t"}]}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"imdata", "=", 
        RowBox[{"sim", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"TableForm", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "\"\<MC:\>\"", "}"}], ",", 
            RowBox[{
             RowBox[{"imdata", "[", 
              RowBox[{"[", "17", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "\"\<Analytic:\>\"", "}"}], ",", 
            RowBox[{
            "FlatlandhalfspaceAlbedoProblemIsotropic`angularMmoments", "[", 
             RowBox[{"\[Alpha]", ",", 
              RowBox[{
               RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`Hmoment", "[", 
                RowBox[{"\[Alpha]", ",", "#"}], "]"}], "&"}]}], "]"}]}], 
           "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Alpha]", ",", "0.99"}], "}"}], ",", 
      "FlatlandhalfspaceAlbedoProblemIsotropic`alphas"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
     "\[CapitalSigma]t", ",", 
      "FlatlandhalfspaceAlbedoProblemIsotropic`muts"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.678243714363831*^9, 3.678243802473928*^9}, {
   3.6782438372745743`*^9, 3.678243918405334*^9}, {3.678244848477655*^9, 
   3.678244871652142*^9}, 3.678244974528975*^9, {3.6783812459205103`*^9, 
   3.678381252573442*^9}, {3.678381299886239*^9, 3.678381302440772*^9}, {
   3.678381482937087*^9, 3.67838152124067*^9}, {3.6783816672515917`*^9, 
   3.678381901224969*^9}, {3.6783819833752737`*^9, 3.678381984893968*^9}, {
   3.678382028434991*^9, 3.678382051113124*^9}, {3.678382476562173*^9, 
   3.678382531616342*^9}, {3.6783825770739527`*^9, 3.6783826434825163`*^9}, {
   3.678382818564744*^9, 3.678382822589374*^9}, {3.6783830180371923`*^9, 
   3.678383070242436*^9}, {3.678383105394609*^9, 3.678383124360643*^9}, {
   3.67838317595117*^9, 3.678383188135069*^9}, {3.678383240059972*^9, 
   3.678383266639002*^9}, {3.6783833301136513`*^9, 3.678383335323216*^9}, {
   3.6783833670062733`*^9, 3.678383463817894*^9}, {3.678383521513876*^9, 
   3.6783835456193733`*^9}, {3.678386332154438*^9, 3.678386560606522*^9}, {
   3.678465505399572*^9, 3.678465538006304*^9}, {3.678465595345571*^9, 
   3.678465657415832*^9}, {3.6784788259692574`*^9, 3.678478861255927*^9}, {
   3.6784790017886677`*^9, 3.6784790764906883`*^9}, {3.67847912413452*^9, 
   3.6784791297973347`*^9}, {3.6790108325055857`*^9, 3.679010850916103*^9}, {
   3.679011009036701*^9, 3.679011009308338*^9}, 3.6790112868995256`*^9, {
   3.67902348087889*^9, 3.679023481708637*^9}, 3.679023648763858*^9, 
   3.679023893722725*^9, {3.679024040083886*^9, 3.679024042826344*^9}, {
   3.679778319713251*^9, 3.679778326542061*^9}, {3.679780908227364*^9, 
   3.679780910009165*^9}, {3.6813503292376842`*^9, 3.681350329548441*^9}, {
   3.681350617607449*^9, 3.681350619603817*^9}, {3.681350840373707*^9, 
   3.681350840788444*^9}, {3.681362776836555*^9, 3.6813628077201557`*^9}, {
   3.681362842217553*^9, 3.68136284556667*^9}, {3.681363064573875*^9, 
   3.681363144688005*^9}, {3.681363178487775*^9, 3.6813631786146297`*^9}, {
   3.681363377486508*^9, 3.681363377692432*^9}, {3.6813635019124403`*^9, 
   3.681363531437456*^9}, {3.681534712953725*^9, 3.681534723690467*^9}, {
   3.735319218084981*^9, 3.735319235215963*^9}},
 CellLabel->
  "In[344]:=",ExpressionUUID->"f9527d05-dfbe-4161-8f3a-068ee5cd4112"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`\[Alpha]$$ = 
    0.99, $CellContext`\[CapitalSigma]t$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`\[Alpha]$$], 0.99}, {0.01, 0.1, 0.3, 0.5, 0.7, 0.8, 
      0.9, 0.95, 0.99, 0.999}}, {
      Hold[$CellContext`\[CapitalSigma]t$$], {1}}}, Typeset`size$$ = {
    337., {12.134033203125, 17.865966796875}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`\[Alpha]$6834219$$ = 
    0, $CellContext`\[CapitalSigma]t$6834220$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`\[Alpha]$$ = 
        0.99, $CellContext`\[CapitalSigma]t$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$6834219$$, 0], 
        Hold[$CellContext`\[CapitalSigma]t$$, \
$CellContext`\[CapitalSigma]t$6834220$$, False]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`imdata$, $CellContext`sim$, $CellContext`dz$, \
$CellContext`maxz$, $CellContext`fluence3$, $CellContext`fluence$, \
$CellContext`stride$, $CellContext`numzs$}, $CellContext`sim$ = 
         SelectFirst[
          FlatlandhalfspaceAlbedoProblemIsotropic`simulationswhitesky, And[
           Part[#, 1] == $CellContext`\[Alpha]$$, 
            Part[#, 2] == $CellContext`\[CapitalSigma]t$$]& ]; \
$CellContext`imdata$ = Part[$CellContext`sim$, 3]; TableForm[{
           Join[{"MC:"}, 
            Part[
             Part[$CellContext`imdata$, 17], 
             Span[1, 3]]], 
           Join[{"Analytic:"}, 
            
            FlatlandhalfspaceAlbedoProblemIsotropic`angularMmoments[$\
CellContext`\[Alpha]$$, 
             FlatlandhalfspaceAlbedoProblemIsotropic`Hmoment[$CellContext`\
\[Alpha]$$, #]& ]]}]], 
      "Specifications" :> {{{$CellContext`\[Alpha]$$, 0.99}, {0.01, 0.1, 0.3, 
         0.5, 0.7, 0.8, 0.9, 0.95, 0.99, 
         0.999}}, {$CellContext`\[CapitalSigma]t$$, {1}}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{382., {71., 77.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.681362792231444*^9, 3.681362808014308*^9}, {
   3.68136284330089*^9, 3.681362845850347*^9}, {3.6813630664971457`*^9, 
   3.681363101795093*^9}, {3.681363145337493*^9, 3.6813631791769238`*^9}, 
   3.681363378012702*^9, {3.681363515852689*^9, 3.68136353181986*^9}, 
   3.681534724229622*^9, 3.6818801046013937`*^9, {3.7353192254157476`*^9, 
   3.735319235566992*^9}, 3.7353198417017517`*^9},
 CellLabel->
  "Out[344]=",ExpressionUUID->"74007e4d-7257-48f0-8d64-0db44c07dd82"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.99`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,68,9,26006911133875019271,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.736484945083198*^9},
 CellLabel->"",ExpressionUUID->"8c022254-8884-43d1-b713-c5a4430b5316"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.99`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,68,10,26006911133875019271,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.736484945107223*^9},
 CellLabel->"",ExpressionUUID->"0bde1860-b6d1-4519-8e65-d0e9a1cc8789"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.99`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,68,11,26006911133875019271,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.736484945115397*^9},
 CellLabel->"",ExpressionUUID->"e2332b5c-2033-4929-9aef-a71c71d165c0"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \
\\\"::\\\", \\\"inumr\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,68,12,26006911133875019271,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7364849451361637`*^9},
 CellLabel->"",ExpressionUUID->"d19771c0-4ae9-4bd7-8634-77229e17054f"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.99`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,69,18,26006911133875019271,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.73648503168964*^9},
 CellLabel->"",ExpressionUUID->"32379b7a-1151-41bd-a2a3-9761efbb499a"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.99`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,69,19,26006911133875019271,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7364850316981697`*^9},
 CellLabel->"",ExpressionUUID->"38cbc0c4-ca22-4d0c-b01e-363167a4d27b"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.99`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,69,20,26006911133875019271,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.736485031720922*^9},
 CellLabel->"",ExpressionUUID->"51aad461-1bdd-4516-b2e5-8540860d599e"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \
\\\"::\\\", \\\"inumr\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,69,21,26006911133875019271,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7364850317431507`*^9},
 CellLabel->"",ExpressionUUID->"f6132590-5bd7-46f6-a875-4b3d83274d3d"],

Cell[BoxData[
 TemplateBox[{
  "SelectFirst","normal",
   "\"Nonatomic expression expected at position \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\) in \\!\\(\\*RowBox[{\\\"SelectFirst\\\", \
\\\"[\\\", \
RowBox[{\\\"FlatlandhalfspaceAlbedoProblemIsotropic`simulationswhitesky\\\", \
\\\",\\\", RowBox[{RowBox[{RowBox[{RowBox[{\\\"#1\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \\\"\
\[Equal]\\\", \\\"FE`\[Alpha]$$17\\\"}], \\\"&&\\\", RowBox[{RowBox[{\\\"#1\\\
\", \\\"\[LeftDoubleBracket]\\\", \\\"2\\\", \\\"\[RightDoubleBracket]\\\"}], \
\\\"\[Equal]\\\", \\\"FE`\[CapitalSigma]t$$17\\\"}]}], \\\"&\\\"}]}], \\\"]\\\
\"}]\\).\"",2,849,141,26062002924779767057,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.745006293218253*^9},
 CellLabel->"",ExpressionUUID->"9e7a9e53-7d12-40d7-a690-ca7dc734144c"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"3\\\"}]\\) of \
\\!\\(\\*RowBox[{\\\"SelectFirst\\\", \\\"[\\\", \
RowBox[{\\\"FlatlandhalfspaceAlbedoProblemIsotropic`simulationswhitesky\\\", \
\\\",\\\", RowBox[{RowBox[{RowBox[{RowBox[{\\\"#1\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \\\"\
\[Equal]\\\", \\\"FE`\[Alpha]$$17\\\"}], \\\"&&\\\", RowBox[{RowBox[{\\\"#1\\\
\", \\\"\[LeftDoubleBracket]\\\", \\\"2\\\", \\\"\[RightDoubleBracket]\\\"}], \
\\\"\[Equal]\\\", \\\"FE`\[CapitalSigma]t$$17\\\"}]}], \\\"&\\\"}]}], \\\"]\\\
\"}]\\) does not exist.\"",2,849,142,26062002924779767057,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.745006293351952*^9},
 CellLabel->"",ExpressionUUID->"710203c6-ed66-4ee8-b59b-310613493040"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"17\\\"}]\\) of \
\\!\\(\\*RowBox[{RowBox[{\\\"SelectFirst\\\", \\\"[\\\", \
RowBox[{\\\"FlatlandhalfspaceAlbedoProblemIsotropic`simulationswhitesky\\\", \
\\\",\\\", RowBox[{RowBox[{RowBox[{RowBox[{\\\"#1\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \\\"\
\[Equal]\\\", \\\"FE`\[Alpha]$$17\\\"}], \\\"&&\\\", RowBox[{RowBox[{\\\"#1\\\
\", \\\"\[LeftDoubleBracket]\\\", \\\"2\\\", \\\"\[RightDoubleBracket]\\\"}], \
\\\"\[Equal]\\\", \\\"FE`\[CapitalSigma]t$$17\\\"}]}], \\\"&\\\"}]}], \\\"]\\\
\"}], \\\"\[LeftDoubleBracket]\\\", \\\"3\\\", \
\\\"\[RightDoubleBracket]\\\"}]\\) does not exist.\"",2,849,143,
   26062002924779767057,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7450062934078503`*^9},
 CellLabel->"",ExpressionUUID->"66a6c29e-5a1d-4850-902c-a6dc6823a148"],

Cell[BoxData[
 TemplateBox[{
  "Part","take",
   "\"Cannot take positions \\!\\(\\*RowBox[{\\\"1\\\"}]\\) through \
\\!\\(\\*RowBox[{\\\"3\\\"}]\\) in \
\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"SelectFirst\\\", \\\"[\\\", \
RowBox[{\\\"FlatlandhalfspaceAlbedoProblemIsotropic`simulationswhitesky\\\", \
\\\",\\\", RowBox[{RowBox[{RowBox[{RowBox[{RowBox[{\\\"Slot\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\"\[LeftDoubleBracket]\\\", \\\"1\\\", \
\\\"\[RightDoubleBracket]\\\"}], \\\"\[Equal]\\\", \\\"FE`\[Alpha]$$17\\\"}], \
\\\"&&\\\", RowBox[{RowBox[{RowBox[{\\\"Slot\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"\
\[LeftDoubleBracket]\\\", \\\"2\\\", \\\"\[RightDoubleBracket]\\\"}], \\\"\
\[Equal]\\\", \\\"FE`\[CapitalSigma]t$$17\\\"}]}], \\\"&\\\"}]}], \
\\\"]\\\"}], \\\"\[LeftDoubleBracket]\\\", \\\"3\\\", \\\"\
\[RightDoubleBracket]\\\"}], \\\"\[LeftDoubleBracket]\\\", \\\"17\\\", \\\"\
\[RightDoubleBracket]\\\"}]\\).\"",2,849,144,26062002924779767057,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.745006293464057*^9},
 CellLabel->"",ExpressionUUID->"43bd17e4-223f-4ef2-9198-b548da071642"],

Cell[BoxData[
 TemplateBox[{
  "Join","heads",
   "\"Heads \\!\\(\\*RowBox[{\\\"List\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"Part\\\"}]\\) at positions \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\) and \\!\\(\\*RowBox[{\\\"2\\\"}]\\) are \
expected to be the same.\"",2,849,145,26062002924779767057,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7450062935194817`*^9},
 CellLabel->"",ExpressionUUID->"d483f1ef-289b-4c30-925a-f3e9c9a61640"],

Cell[BoxData[
 TemplateBox[{
  "Join","heads",
   "\"Heads \\!\\(\\*RowBox[{\\\"List\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"FlatlandhalfspaceAlbedoProblemIsotropic`angularMmoments\\\
\"}]\\) at positions \\!\\(\\*RowBox[{\\\"1\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"2\\\"}]\\) are expected to be the same.\"",2,849,146,
   26062002924779767057,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.745006293573645*^9},
 CellLabel->"",ExpressionUUID->"8e019047-d28c-49b8-9a46-37730009658a"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Spatial Moments of Fluence - Delta Illumination", "Subsection",
 CellChangeTimes->{{3.681362744916136*^9, 3.681362757513769*^9}, {
  3.681363495943247*^9, 3.681363497149448*^9}, {3.6815349926896477`*^9, 
  3.681534997136842*^9}, {3.681551424473092*^9, 
  3.6815514266621323`*^9}},ExpressionUUID->"e9932eea-445e-439c-ac69-\
cfc529d70a8d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "imdata", ",", "sim", ",", "dz", ",", "maxz", ",", "fluence3", ",", 
        "fluence", ",", "stride", ",", "numzs"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sim", "=", 
        RowBox[{"SelectFirst", "[", 
         RowBox[{
         "FlatlandhalfspaceAlbedoProblemIsotropic`simulationsdelta", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "ui"}], "&&", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
            
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
             "\[CapitalSigma]t"}]}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"imdata", "=", 
        RowBox[{"sim", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"TableForm", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "\"\<MC:\>\"", "}"}], ",", 
            RowBox[{
             RowBox[{"imdata", "[", 
              RowBox[{"[", "15", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "5"}], "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "\"\<Analytic:\>\"", "}"}], ",", 
            RowBox[{
            "FlatlandhalfspaceAlbedoProblemIsotropic`spatialMoments", "[", 
             RowBox[{"\[Alpha]", ",", "ui", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`H", "[", 
                RowBox[{"\[Alpha]", ",", "#"}], "]"}], "&"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`Hmoment", "[", 
                RowBox[{"\[Alpha]", ",", "#"}], "]"}], "&"}]}], 
             "\[IndentingNewLine]", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
         "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Alpha]", ",", "0.99"}], "}"}], ",", 
      "FlatlandhalfspaceAlbedoProblemIsotropic`alphas"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ui", ",", "0.5"}], "}"}], ",", 
      "FlatlandhalfspaceAlbedoProblemIsotropic`uis"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
     "\[CapitalSigma]t", ",", 
      "FlatlandhalfspaceAlbedoProblemIsotropic`muts"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.678243714363831*^9, 3.678243802473928*^9}, {
   3.6782438372745743`*^9, 3.678243918405334*^9}, {3.678244848477655*^9, 
   3.678244871652142*^9}, 3.678244974528975*^9, {3.6783812459205103`*^9, 
   3.678381252573442*^9}, {3.678381299886239*^9, 3.678381302440772*^9}, {
   3.678381482937087*^9, 3.67838152124067*^9}, {3.6783816672515917`*^9, 
   3.678381901224969*^9}, {3.6783819833752737`*^9, 3.678381984893968*^9}, {
   3.678382028434991*^9, 3.678382051113124*^9}, {3.678382476562173*^9, 
   3.678382531616342*^9}, {3.6783825770739527`*^9, 3.6783826434825163`*^9}, {
   3.678382818564744*^9, 3.678382822589374*^9}, {3.6783830180371923`*^9, 
   3.678383070242436*^9}, {3.678383105394609*^9, 3.678383124360643*^9}, {
   3.67838317595117*^9, 3.678383188135069*^9}, {3.678383240059972*^9, 
   3.678383266639002*^9}, {3.6783833301136513`*^9, 3.678383335323216*^9}, {
   3.6783833670062733`*^9, 3.678383463817894*^9}, {3.678383521513876*^9, 
   3.6783835456193733`*^9}, {3.678386332154438*^9, 3.678386560606522*^9}, {
   3.678465505399572*^9, 3.678465538006304*^9}, {3.678465595345571*^9, 
   3.678465657415832*^9}, {3.6784788259692574`*^9, 3.678478861255927*^9}, {
   3.6784790017886677`*^9, 3.6784790764906883`*^9}, {3.67847912413452*^9, 
   3.6784791297973347`*^9}, {3.6790108325055857`*^9, 3.679010850916103*^9}, {
   3.679011009036701*^9, 3.679011009308338*^9}, 3.6790112868995256`*^9, {
   3.67902348087889*^9, 3.679023481708637*^9}, 3.679023648763858*^9, 
   3.679023893722725*^9, {3.679024040083886*^9, 3.679024042826344*^9}, {
   3.679778319713251*^9, 3.679778326542061*^9}, {3.679780908227364*^9, 
   3.679780910009165*^9}, {3.6813503292376842`*^9, 3.681350329548441*^9}, {
   3.681350617607449*^9, 3.681350619603817*^9}, {3.681350840373707*^9, 
   3.681350840788444*^9}, {3.681362776836555*^9, 3.6813628077201557`*^9}, {
   3.681362842217553*^9, 3.68136284556667*^9}, {3.681363064573875*^9, 
   3.681363144688005*^9}, {3.681363178487775*^9, 3.6813631786146297`*^9}, {
   3.681363377486508*^9, 3.681363377692432*^9}, {3.6813635019124403`*^9, 
   3.681363531437456*^9}, {3.681534712953725*^9, 3.681534723690467*^9}, {
   3.681535006242292*^9, 3.6815350176337223`*^9}, {3.6815514458354387`*^9, 
   3.681551465318316*^9}, 3.681551982076336*^9, 3.681553250515729*^9, {
   3.681706329252136*^9, 3.681706329409402*^9}, {3.681706374927372*^9, 
   3.681706380412676*^9}, {3.7342798640686417`*^9, 3.734279873761788*^9}},
 CellLabel->
  "In[225]:=",ExpressionUUID->"91e13757-9cef-4779-987c-4892b2e8190d"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`ui$$ = 0.5, $CellContext`\[Alpha]$$ = 
    0.99, $CellContext`\[CapitalSigma]t$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`\[Alpha]$$], 0.99}, {0.01, 0.1, 0.3, 0.5, 0.7, 0.8, 
      0.9, 0.95, 0.99, 0.999}}, {{
       Hold[$CellContext`ui$$], 0.5}, {0.1, 0.25, 0.5, 1}}, {
      Hold[$CellContext`\[CapitalSigma]t$$], {1}}}, Typeset`size$$ = {
    62., {2., 10.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`\[Alpha]$4313413$$ = 
    0, $CellContext`ui$4313414$$ = 
    0, $CellContext`\[CapitalSigma]t$4313415$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`ui$$ = 0.5, $CellContext`\[Alpha]$$ = 
        0.99, $CellContext`\[CapitalSigma]t$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$4313413$$, 0], 
        Hold[$CellContext`ui$$, $CellContext`ui$4313414$$, 0], 
        Hold[$CellContext`\[CapitalSigma]t$$, \
$CellContext`\[CapitalSigma]t$4313415$$, False]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`imdata$, $CellContext`sim$, $CellContext`dz$, \
$CellContext`maxz$, $CellContext`fluence3$, $CellContext`fluence$, \
$CellContext`stride$, $CellContext`numzs$}, $CellContext`sim$ = 
         SelectFirst[
          FlatlandhalfspaceAlbedoProblemIsotropic`simulationsdelta, And[
           Part[#, 3] == $CellContext`ui$$, 
            Part[#, 1] == $CellContext`\[Alpha]$$, 
            Part[#, 2] == $CellContext`\[CapitalSigma]t$$]& ]; \
$CellContext`imdata$ = Part[$CellContext`sim$, 4]; TableForm[{
           Join[{"MC:"}, 
            Part[
             Part[$CellContext`imdata$, 15], 
             Span[1, 5]]], 
           Join[{"Analytic:"}, 
            
            FlatlandhalfspaceAlbedoProblemIsotropic`spatialMoments[$\
CellContext`\[Alpha]$$, $CellContext`ui$$, 
             FlatlandhalfspaceAlbedoProblemIsotropic`H[$CellContext`\[Alpha]$$\
, #]& , FlatlandhalfspaceAlbedoProblemIsotropic`Hmoment[$CellContext`\[Alpha]$\
$, #]& ]]}]], 
      "Specifications" :> {{{$CellContext`\[Alpha]$$, 0.99}, {0.01, 0.1, 0.3, 
         0.5, 0.7, 0.8, 0.9, 0.95, 0.99, 0.999}}, {{$CellContext`ui$$, 0.5}, {
         0.1, 0.25, 0.5, 1}}, {$CellContext`\[CapitalSigma]t$$, {1}}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{137., {77., 83.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.681362792231444*^9, 3.681362808014308*^9}, {
   3.68136284330089*^9, 3.681362845850347*^9}, {3.6813630664971457`*^9, 
   3.681363101795093*^9}, {3.681363145337493*^9, 3.6813631791769238`*^9}, 
   3.681363378012702*^9, {3.681363515852689*^9, 3.68136353181986*^9}, 
   3.681534724229622*^9, {3.68153500990979*^9, 3.681535017903261*^9}, {
   3.681551454532667*^9, 3.681551465766432*^9}, 3.68155198267594*^9, {
   3.68155324294741*^9, 3.6815532519740553`*^9}, 3.6817063298195877`*^9, 
   3.681706378098892*^9, 3.68170651539703*^9, 3.681880104649427*^9, 
   3.73427987420979*^9, {3.734280458863365*^9, 3.734280468878293*^9}, 
   3.735095490581324*^9, 3.735095541300474*^9, 3.7350956929703083`*^9, 
   3.735151149524535*^9, {3.748325429756106*^9, 3.748325433504245*^9}, 
   3.748325496945002*^9},
 CellLabel->
  "Out[225]=",ExpressionUUID->"07fbab13-90bd-4231-b0d0-e6454c9d386e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Spatial Moments of Fluence - White-Sky", "Subsection",
 CellChangeTimes->{{3.681362744916136*^9, 3.681362757513769*^9}, {
  3.681363495943247*^9, 3.681363497149448*^9}, {3.6815349926896477`*^9, 
  3.681534997136842*^9}},ExpressionUUID->"10391084-cb56-4ac4-bc75-\
c547f24e44ec"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "imdata", ",", "sim", ",", "dz", ",", "maxz", ",", "fluence3", ",", 
        "fluence", ",", "stride", ",", "numzs"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sim", "=", 
        RowBox[{"SelectFirst", "[", 
         RowBox[{
         "FlatlandhalfspaceAlbedoProblemIsotropic`simulationswhitesky", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
            
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
             "\[CapitalSigma]t"}]}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"imdata", "=", 
        RowBox[{"sim", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"TableForm", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "\"\<MC:\>\"", "}"}], ",", 
            RowBox[{
             RowBox[{"imdata", "[", 
              RowBox[{"[", "15", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "\"\<Analytic:\>\"", "}"}], ",", 
            RowBox[{
            "FlatlandhalfspaceAlbedoProblemIsotropic`spatialMoments", "[", 
             RowBox[{"\[Alpha]", ",", 
              RowBox[{
               RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`Hmoment", "[", 
                RowBox[{"\[Alpha]", ",", "#"}], "]"}], "&"}]}], "]"}]}], 
           "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Alpha]", ",", "0.99"}], "}"}], ",", 
      "FlatlandhalfspaceAlbedoProblemIsotropic`alphas"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
     "\[CapitalSigma]t", ",", 
      "FlatlandhalfspaceAlbedoProblemIsotropic`muts"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.678243714363831*^9, 3.678243802473928*^9}, {
   3.6782438372745743`*^9, 3.678243918405334*^9}, {3.678244848477655*^9, 
   3.678244871652142*^9}, 3.678244974528975*^9, {3.6783812459205103`*^9, 
   3.678381252573442*^9}, {3.678381299886239*^9, 3.678381302440772*^9}, {
   3.678381482937087*^9, 3.67838152124067*^9}, {3.6783816672515917`*^9, 
   3.678381901224969*^9}, {3.6783819833752737`*^9, 3.678381984893968*^9}, {
   3.678382028434991*^9, 3.678382051113124*^9}, {3.678382476562173*^9, 
   3.678382531616342*^9}, {3.6783825770739527`*^9, 3.6783826434825163`*^9}, {
   3.678382818564744*^9, 3.678382822589374*^9}, {3.6783830180371923`*^9, 
   3.678383070242436*^9}, {3.678383105394609*^9, 3.678383124360643*^9}, {
   3.67838317595117*^9, 3.678383188135069*^9}, {3.678383240059972*^9, 
   3.678383266639002*^9}, {3.6783833301136513`*^9, 3.678383335323216*^9}, {
   3.6783833670062733`*^9, 3.678383463817894*^9}, {3.678383521513876*^9, 
   3.6783835456193733`*^9}, {3.678386332154438*^9, 3.678386560606522*^9}, {
   3.678465505399572*^9, 3.678465538006304*^9}, {3.678465595345571*^9, 
   3.678465657415832*^9}, {3.6784788259692574`*^9, 3.678478861255927*^9}, {
   3.6784790017886677`*^9, 3.6784790764906883`*^9}, {3.67847912413452*^9, 
   3.6784791297973347`*^9}, {3.6790108325055857`*^9, 3.679010850916103*^9}, {
   3.679011009036701*^9, 3.679011009308338*^9}, 3.6790112868995256`*^9, {
   3.67902348087889*^9, 3.679023481708637*^9}, 3.679023648763858*^9, 
   3.679023893722725*^9, {3.679024040083886*^9, 3.679024042826344*^9}, {
   3.679778319713251*^9, 3.679778326542061*^9}, {3.679780908227364*^9, 
   3.679780910009165*^9}, {3.6813503292376842`*^9, 3.681350329548441*^9}, {
   3.681350617607449*^9, 3.681350619603817*^9}, {3.681350840373707*^9, 
   3.681350840788444*^9}, {3.681362776836555*^9, 3.6813628077201557`*^9}, {
   3.681362842217553*^9, 3.68136284556667*^9}, {3.681363064573875*^9, 
   3.681363144688005*^9}, {3.681363178487775*^9, 3.6813631786146297`*^9}, {
   3.681363377486508*^9, 3.681363377692432*^9}, {3.6813635019124403`*^9, 
   3.681363531437456*^9}, {3.681534712953725*^9, 3.681534723690467*^9}, {
   3.681535006242292*^9, 3.6815350176337223`*^9}, {3.7353201321872253`*^9, 
   3.735320140455205*^9}},
 CellLabel->
  "In[345]:=",ExpressionUUID->"abe23d67-6c10-4f80-832a-47f3929b2acd"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`\[Alpha]$$ = 
    0.7, $CellContext`\[CapitalSigma]t$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`\[Alpha]$$], 0.99}, {0.01, 0.1, 0.3, 0.5, 0.7, 0.8, 
      0.9, 0.95, 0.99, 0.999}}, {
      Hold[$CellContext`\[CapitalSigma]t$$], {1}}}, Typeset`size$$ = {
    1351., {12.134033203125, 17.865966796875}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`\[Alpha]$6985299$$ = 
    0, $CellContext`\[CapitalSigma]t$6985300$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`\[Alpha]$$ = 
        0.99, $CellContext`\[CapitalSigma]t$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$6985299$$, 0], 
        Hold[$CellContext`\[CapitalSigma]t$$, \
$CellContext`\[CapitalSigma]t$6985300$$, False]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`imdata$, $CellContext`sim$, $CellContext`dz$, \
$CellContext`maxz$, $CellContext`fluence3$, $CellContext`fluence$, \
$CellContext`stride$, $CellContext`numzs$}, $CellContext`sim$ = 
         SelectFirst[
          FlatlandhalfspaceAlbedoProblemIsotropic`simulationswhitesky, And[
           Part[#, 1] == $CellContext`\[Alpha]$$, 
            Part[#, 2] == $CellContext`\[CapitalSigma]t$$]& ]; \
$CellContext`imdata$ = Part[$CellContext`sim$, 3]; TableForm[{
           Join[{"MC:"}, 
            Part[
             Part[$CellContext`imdata$, 15], 
             Span[1, 3]]], 
           Join[{"Analytic:"}, 
            
            FlatlandhalfspaceAlbedoProblemIsotropic`spatialMoments[$\
CellContext`\[Alpha]$$, 
             FlatlandhalfspaceAlbedoProblemIsotropic`Hmoment[$CellContext`\
\[Alpha]$$, #]& ]]}]], 
      "Specifications" :> {{{$CellContext`\[Alpha]$$, 0.99}, {0.01, 0.1, 0.3, 
         0.5, 0.7, 0.8, 0.9, 0.95, 0.99, 
         0.999}}, {$CellContext`\[CapitalSigma]t$$, {1}}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{4.503599627370496*^15, {71., 77.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.681362792231444*^9, 3.681362808014308*^9}, {
   3.68136284330089*^9, 3.681362845850347*^9}, {3.6813630664971457`*^9, 
   3.681363101795093*^9}, {3.681363145337493*^9, 3.6813631791769238`*^9}, 
   3.681363378012702*^9, {3.681363515852689*^9, 3.68136353181986*^9}, 
   3.681534724229622*^9, {3.68153500990979*^9, 3.681535017903261*^9}, 
   3.681880104703672*^9, 3.735320140743998*^9},
 CellLabel->
  "Out[345]=",ExpressionUUID->"33f758a7-85d3-4d28-84d8-47bb8f9b51ae"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.9`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,346,244,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7353201507788754`*^9},
 CellLabel->"",ExpressionUUID->"e9b1f024-6a1b-49a7-a8a8-7586be8860a8"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.9`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,346,245,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735320150807467*^9},
 CellLabel->"",ExpressionUUID->"c935f918-221b-40d5-93b8-9aefbb6934c8"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.9`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,346,246,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735320150829104*^9},
 CellLabel->"",ExpressionUUID->"7f845559-00e9-4bde-8d88-3b358607a2b1"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \
\\\"::\\\", \\\"inumr\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,346,247,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735320150850996*^9},
 CellLabel->"",ExpressionUUID->"089b5f1a-5fbf-47a9-94e9-f12f7100a1dc"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.5`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,348,256,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7353202373949127`*^9},
 CellLabel->"",ExpressionUUID->"52319290-a882-4ce1-949e-1ad3ee92a262"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.5`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,348,257,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.73532023741612*^9},
 CellLabel->"",ExpressionUUID->"a1bc9a84-0fe3-4999-938c-2fcdd4acc309"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.5`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,348,258,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735320237441655*^9},
 CellLabel->"",ExpressionUUID->"5b2c7137-2d19-402d-9abe-48fcf1fa795b"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \
\\\"::\\\", \\\"inumr\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,348,259,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735320237452129*^9},
 CellLabel->"",ExpressionUUID->"21de31fa-bb87-4f96-a9fc-4bf526b05342"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.999`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,348,260,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7353202473358173`*^9},
 CellLabel->"",ExpressionUUID->"9b8bff83-66d4-43d6-ae95-2153cd1c9212"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.999`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,348,261,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7353202473445797`*^9},
 CellLabel->"",ExpressionUUID->"6d478ee6-1047-4df3-8d87-c88656b6c29a"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.999`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,348,262,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735320247365869*^9},
 CellLabel->"",ExpressionUUID->"a651af39-320f-4a86-a7d2-963998bfef69"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \
\\\"::\\\", \\\"inumr\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,348,263,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735320247390136*^9},
 CellLabel->"",ExpressionUUID->"f7979294-5c12-4423-9e54-a9efd399b8aa"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.999`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,349,268,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735320443892436*^9},
 CellLabel->"",ExpressionUUID->"b1535041-fcad-40d0-a618-0d06070299f4"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.999`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,349,269,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735320443914096*^9},
 CellLabel->"",ExpressionUUID->"0ae5a0bf-53bf-4f2d-9a53-8a0a52a9daea"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.999`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,349,270,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735320443933015*^9},
 CellLabel->"",ExpressionUUID->"3a0dff93-69af-4a34-a16a-4b4bb1cb7c7f"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \
\\\"::\\\", \\\"inumr\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,349,271,25997236447462142403,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.735320443952273*^9},
 CellLabel->"",ExpressionUUID->"67272e8a-74ab-42cc-9496-50a5d878d750"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.7`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,69,22,26006911133875019271,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.736485068518512*^9},
 CellLabel->"",ExpressionUUID->"20c7e1cd-ab72-45cd-a76b-cc9a03253d5a"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.7`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,69,23,26006911133875019271,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.736485068551495*^9},
 CellLabel->"",ExpressionUUID->"7fcd9412-f57d-4fee-b100-75d05d77d73a"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*FractionBox[RowBox[{\\\"t\\\", \\\" \\\", \
RowBox[{\\\"ArcTan\\\", \\\"[\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"u\\\"}], \
\\\"]\\\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"+\\\", \
SuperscriptBox[\\\"t\\\", \\\"2\\\"]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"0.7`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
SqrtBox[RowBox[{\\\"1\\\", \\\"+\\\", SuperscriptBox[\\\"t\\\", \
\\\"2\\\"]}]]}], \\\")\\\"}]}]]\\) has evaluated to non-numerical values for \
all sampling points in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[Infinity]\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\"}\\\"}]\\).\"",2,69,24,26006911133875019271,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.73648506856991*^9},
 CellLabel->"",ExpressionUUID->"0677754b-3d42-4e84-903a-53d1e038fdc1"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \
\\\"::\\\", \\\"inumr\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,69,25,26006911133875019271,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.736485068588291*^9},
 CellLabel->"",ExpressionUUID->"c733957a-3fa6-4634-affd-318a9dc4635d"],

Cell[BoxData[
 TemplateBox[{
  "Join","heads",
   "\"Heads \\!\\(\\*RowBox[{\\\"List\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"FlatlandhalfspaceAlbedoProblemIsotropic`spatialMoments\\\
\"}]\\) at positions \\!\\(\\*RowBox[{\\\"1\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"2\\\"}]\\) are expected to be the same.\"",2,212,32,
   26083907564578680681,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.748325311446787*^9},
 CellLabel->"",ExpressionUUID->"c6ee9e41-f409-4ad8-9098-d4fba96d9e09"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Internal", "Section",
 CellChangeTimes->{{3.7350963662564507`*^9, 
  3.7350963674068623`*^9}},ExpressionUUID->"933a287f-e8a3-415a-86d8-\
05bde0677de4"],

Cell[CellGroupData[{

Cell["Delta Illumination - Fluence - Exact Solution", "Subsection",
 CellChangeTimes->{{3.6797810490842543`*^9, 3.6797810541791687`*^9}, {
  3.6797814205621643`*^9, 
  3.679781425488174*^9}},ExpressionUUID->"cd4ede3b-dade-468a-a4af-\
937a542fbbea"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "imdata", ",", "sim", ",", "dz", ",", "maxz", ",", "fluence3", ",", 
        "fluence", ",", "stride", ",", "numzs"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sim", "=", 
        RowBox[{"SelectFirst", "[", 
         RowBox[{
         "FlatlandhalfspaceAlbedoProblemIsotropic`simulationsdelta", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "ui"}], "&&", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\[Alpha]"}], "&&", 
            
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
             "\[CapitalSigma]t"}]}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"imdata", "=", 
        RowBox[{"sim", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"maxz", "=", 
        RowBox[{"imdata", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "7"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dz", "=", 
        RowBox[{"imdata", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "9"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"stride", "=", "3"}], ";", "\[IndentingNewLine]", 
       RowBox[{"numzs", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"imdata", "[", 
          RowBox[{"[", "13", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fluence", "=", 
        RowBox[{
         RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints", "[", 
          RowBox[{
           RowBox[{"imdata", "[", 
            RowBox[{"[", "13", "]"}], "]"}], ",", "dz"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", 
           RowBox[{"Floor", "[", 
            RowBox[{"numzs", "/", "5"}], "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fluence3", "=", 
        RowBox[{
         RowBox[{"FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints", "[", 
          RowBox[{
           RowBox[{"imdata", "[", 
            RowBox[{"[", "13", "]"}], "]"}], ",", "dz"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", 
           RowBox[{"-", "1"}], ";;", "stride"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
        RowBox[{"GraphicsRow", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Show", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Plot", "[", 
                RowBox[{
                 RowBox[{"2", " ", "Pi", " ", 
                  RowBox[{
                  "FlatlandhalfspaceAlbedoProblemIsotropic`\[Phi]\
rigorousdiffusion", "[", 
                   RowBox[{"z", ",", "\[Alpha]", ",", "ui"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"z", ",", "0", ",", 
                   FractionBox["maxz", "5"]}], "}"}], ",", 
                 RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ListPlot", "[", 
                RowBox[{"fluence", ",", 
                 RowBox[{"PlotStyle", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"PointSize", "[", "0.004", "]"}], ",", "Black"}], 
                   "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Phi]", "[", "z", "]"}], ","}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"z", ",", 
                  RowBox[{
                  "\"\<Fluence \[Phi](z): Flatland isotropically-scattering \
half space\\nincidence (\!\(\*SubscriptBox[\(u\), \(i\)]\)=\>\"", "<>", 
                   RowBox[{"ToString", "[", "ui", "]"}], "<>", 
                   "\"\<), indexed-matched boundary, c = \>\"", "<>", 
                   RowBox[{"ToString", "[", "\[Alpha]", "]"}]}]}], "}"}]}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Show", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"LogPlot", "[", 
                RowBox[{
                 RowBox[{"2", " ", "Pi", " ", 
                  RowBox[{
                  "FlatlandhalfspaceAlbedoProblemIsotropic`\[Phi]\
rigorousdiffusion", "[", 
                   RowBox[{"z", ",", "\[Alpha]", ",", "ui"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"z", ",", "0", ",", "maxz"}], "}"}], ",", 
                 RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ListLogPlot", "[", 
                RowBox[{"fluence3", ",", 
                 RowBox[{"PlotStyle", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"PointSize", "[", "0.004", "]"}], ",", "Black"}], 
                   "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Phi]", "[", "z", "]"}], ","}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"z", ",", 
                  RowBox[{
                  "\"\<Fluence \[Phi](z): Flatland isotropically-scattering \
half space\\nincidence (\!\(\*SubscriptBox[\(u\), \(i\)]\)=\>\"", "<>", 
                   RowBox[{"ToString", "[", "ui", "]"}], "<>", 
                   "\"\<), indexed-matched boundary, c = \>\"", "<>", 
                   RowBox[{"ToString", "[", "\[Alpha]", "]"}]}]}], "}"}]}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "}"}], "]"}], "\[IndentingNewLine]", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Alpha]", ",", "0.99"}], "}"}], ",", 
      "FlatlandhalfspaceAlbedoProblemIsotropic`alphas"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ui", ",", "0.5"}], "}"}], ",", 
      "FlatlandhalfspaceAlbedoProblemIsotropic`uis"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
     "\[CapitalSigma]t", ",", 
      "FlatlandhalfspaceAlbedoProblemIsotropic`muts"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.678243714363831*^9, 3.678243802473928*^9}, {
   3.6782438372745743`*^9, 3.678243918405334*^9}, {3.678244848477655*^9, 
   3.678244871652142*^9}, 3.678244974528975*^9, {3.6783812459205103`*^9, 
   3.678381252573442*^9}, {3.678381299886239*^9, 3.678381302440772*^9}, {
   3.678381482937087*^9, 3.67838152124067*^9}, {3.6783816672515917`*^9, 
   3.678381901224969*^9}, {3.6783819833752737`*^9, 3.678381984893968*^9}, {
   3.678382028434991*^9, 3.678382051113124*^9}, {3.678382476562173*^9, 
   3.678382531616342*^9}, {3.6783825770739527`*^9, 3.6783826434825163`*^9}, {
   3.678382818564744*^9, 3.678382822589374*^9}, {3.6783830180371923`*^9, 
   3.678383070242436*^9}, {3.678383105394609*^9, 3.678383124360643*^9}, {
   3.67838317595117*^9, 3.678383188135069*^9}, {3.678383240059972*^9, 
   3.678383266639002*^9}, {3.6783833301136513`*^9, 3.678383335323216*^9}, {
   3.6783833670062733`*^9, 3.678383463817894*^9}, {3.678383521513876*^9, 
   3.6783835456193733`*^9}, {3.678386332154438*^9, 3.678386560606522*^9}, {
   3.678465505399572*^9, 3.678465538006304*^9}, {3.678465595345571*^9, 
   3.678465657415832*^9}, {3.6784788259692574`*^9, 3.678478861255927*^9}, {
   3.6784790017886677`*^9, 3.6784790764906883`*^9}, {3.67847912413452*^9, 
   3.6784791297973347`*^9}, {3.6790108325055857`*^9, 3.679010850916103*^9}, {
   3.679011009036701*^9, 3.679011009308338*^9}, 3.6790112868995256`*^9, {
   3.67902348087889*^9, 3.679023481708637*^9}, 3.679023648763858*^9, 
   3.679023893722725*^9, {3.679024040083886*^9, 3.679024042826344*^9}, {
   3.679778319713251*^9, 3.679778326542061*^9}, {3.679780908227364*^9, 
   3.679780910009165*^9}, {3.6813503292376842`*^9, 3.681350329548441*^9}, {
   3.681350617607449*^9, 3.681350619603817*^9}, {3.681350840373707*^9, 
   3.681350840788444*^9}, {3.7350963740694942`*^9, 3.735096389073662*^9}, {
   3.735096431559235*^9, 3.735096433224551*^9}, {3.7351511674990797`*^9, 
   3.735151189474042*^9}, {3.7351682629235077`*^9, 3.735168316320403*^9}, {
   3.735168455826482*^9, 3.735168458730146*^9}, 3.735179070919633*^9},
 CellLabel->
  "In[891]:=",ExpressionUUID->"77367875-19c6-4311-b6ed-2d75ea4fbc66"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`ui$$ = 0.5, $CellContext`\[Alpha]$$ = 
    0.7, $CellContext`\[CapitalSigma]t$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`\[Alpha]$$], 0.99}, {0.01, 0.1, 0.3, 0.5, 0.7, 0.8, 
      0.9, 0.95, 0.99, 0.999}}, {{
       Hold[$CellContext`ui$$], 0.5}, {0.1, 0.25, 0.5, 1}}, {
      Hold[$CellContext`\[CapitalSigma]t$$], {1}}}, Typeset`size$$ = {
    1079., {166., 170.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`\[Alpha]$11591625$$ = 
    0, $CellContext`ui$11591626$$ = 
    0, $CellContext`\[CapitalSigma]t$11591627$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`ui$$ = 0.5, $CellContext`\[Alpha]$$ = 
        0.99, $CellContext`\[CapitalSigma]t$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$11591625$$, 0], 
        Hold[$CellContext`ui$$, $CellContext`ui$11591626$$, 0], 
        Hold[$CellContext`\[CapitalSigma]t$$, \
$CellContext`\[CapitalSigma]t$11591627$$, False]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`imdata$, $CellContext`sim$, $CellContext`dz$, \
$CellContext`maxz$, $CellContext`fluence3$, $CellContext`fluence$, \
$CellContext`stride$, $CellContext`numzs$}, $CellContext`sim$ = 
         SelectFirst[
          FlatlandhalfspaceAlbedoProblemIsotropic`simulationsdelta, And[
           Part[#, 3] == $CellContext`ui$$, 
            Part[#, 1] == $CellContext`\[Alpha]$$, 
            Part[#, 2] == $CellContext`\[CapitalSigma]t$$]& ]; \
$CellContext`imdata$ = Part[$CellContext`sim$, 4]; $CellContext`maxz$ = 
         Part[$CellContext`imdata$, 2, 7]; $CellContext`dz$ = 
         Part[$CellContext`imdata$, 2, 9]; $CellContext`stride$ = 
         3; $CellContext`numzs$ = Length[
           Part[$CellContext`imdata$, 13]]; $CellContext`fluence$ = Part[
           FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints[
            Part[$CellContext`imdata$, 13], $CellContext`dz$], 
           Span[1, 
            Floor[$CellContext`numzs$/5]]]; $CellContext`fluence3$ = Part[
           FlatlandhalfspaceAlbedoProblemIsotropic`plotpoints[
            Part[$CellContext`imdata$, 13], $CellContext`dz$], 
           Span[1, -1, $CellContext`stride$]]; Quiet[
          GraphicsRow[{
            Show[
             Show[
              Plot[
              2 Pi FlatlandhalfspaceAlbedoProblemIsotropic`\[Phi]\
rigorousdiffusion[$CellContext`z, $CellContext`\[Alpha]$$, \
$CellContext`ui$$], {$CellContext`z, 0, $CellContext`maxz$/5}, PlotRange -> 
               All], 
              ListPlot[$CellContext`fluence$, PlotStyle -> {
                 PointSize[0.004], Black}]], Frame -> True, ImageSize -> 500, 
             FrameLabel -> {{
                $CellContext`\[Phi][$CellContext`z], Null}, {$CellContext`z, 
                StringJoin[
                "Fluence \[Phi](z): Flatland isotropically-scattering half \
space\nincidence (\!\(\*SubscriptBox[\(u\), \(i\)]\)=", 
                 ToString[$CellContext`ui$$], 
                 "), indexed-matched boundary, c = ", 
                 ToString[$CellContext`\[Alpha]$$]]}}], 
            Show[
             Show[
              LogPlot[
              2 Pi FlatlandhalfspaceAlbedoProblemIsotropic`\[Phi]\
rigorousdiffusion[$CellContext`z, $CellContext`\[Alpha]$$, \
$CellContext`ui$$], {$CellContext`z, 0, $CellContext`maxz$}, PlotRange -> 
               All], 
              ListLogPlot[$CellContext`fluence3$, PlotStyle -> {
                 PointSize[0.004], Black}]], Frame -> True, ImageSize -> 500, 
             FrameLabel -> {{
                $CellContext`\[Phi][$CellContext`z], Null}, {$CellContext`z, 
                StringJoin[
                "Fluence \[Phi](z): Flatland isotropically-scattering half \
space\nincidence (\!\(\*SubscriptBox[\(u\), \(i\)]\)=", 
                 ToString[$CellContext`ui$$], 
                 "), indexed-matched boundary, c = ", 
                 ToString[$CellContext`\[Alpha]$$]]}}]}]]], 
      "Specifications" :> {{{$CellContext`\[Alpha]$$, 0.99}, {0.01, 0.1, 0.3, 
         0.5, 0.7, 0.8, 0.9, 0.95, 0.99, 0.999}}, {{$CellContext`ui$$, 0.5}, {
         0.1, 0.25, 0.5, 1}}, {$CellContext`\[CapitalSigma]t$$, {1}}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{1124., {236., 242.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.67838656113239*^9, 3.678465538578746*^9, {3.67846561710701*^9, 
   3.678465657874633*^9}, {3.67847884197654*^9, 3.678478861642757*^9}, 
   3.67847908071314*^9, 3.678479142276745*^9, 3.679010851871318*^9, 
   3.679011011748683*^9, 3.679011311998128*^9, 3.679023491791195*^9, 
   3.679023659599296*^9, 3.679023904155217*^9, 3.679024056475607*^9, 
   3.679765678934637*^9, 3.6797780475545187`*^9, 3.679778358414218*^9, 
   3.679780925309901*^9, 3.680341323478178*^9, 3.68134947413279*^9, 
   3.681350408532567*^9, 3.681350695053619*^9, 3.6818801006934137`*^9, 
   3.735096389535561*^9, 3.735096433634194*^9, 3.735096486899831*^9, 
   3.735096761985652*^9, {3.7351511811958427`*^9, 3.735151190032619*^9}, 
   3.7351683064763308`*^9, {3.7351684503447227`*^9, 3.735168460015233*^9}, 
   3.735168553677128*^9, 3.735179071346636*^9, 3.7450063909549103`*^9},
 CellLabel->
  "Out[891]=",ExpressionUUID->"32924555-153b-4d08-b366-642b8a367765"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
WindowSize->{990, 905},
WindowMargins->{{Automatic, 60}, {36, Automatic}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 536, 8, 160, "Title",ExpressionUUID->"945888db-42c8-49ee-958e-9dd5718626bd"],
Cell[1119, 32, 173, 3, 53, "Subtitle",ExpressionUUID->"8546f458-c8a6-4706-8897-ca564bab4016"],
Cell[1295, 37, 689, 13, 142, "Text",ExpressionUUID->"b723fccc-692a-4c7e-905a-4deb2dfa81a6"],
Cell[CellGroupData[{
Cell[2009, 54, 203, 4, 67, "Section",ExpressionUUID->"f67a006d-c5db-477a-8e67-e9037b26f814"],
Cell[2215, 60, 313, 7, 58, "Text",ExpressionUUID->"5af5a75c-e67c-4a0c-8f3d-7b9a30e5b894"],
Cell[CellGroupData[{
Cell[2553, 71, 205, 4, 30, "Input",ExpressionUUID->"2de1b81a-bbed-42ba-9aa3-c10b4498ba33"],
Cell[2761, 77, 423, 7, 34, "Output",ExpressionUUID->"1281102e-c6e2-4840-b6b5-901ea7deb7e2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[3233, 90, 153, 3, 67, "Section",ExpressionUUID->"fa6eb5d8-51fd-4f92-b110-375b6f24e333"],
Cell[3389, 95, 617, 12, 104, "Text",ExpressionUUID->"9f0f012a-fb64-4e3e-8c55-50b646f0d36d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4043, 112, 305, 5, 67, "Section",ExpressionUUID->"bd110267-8782-471c-9a40-5826de020bc5"],
Cell[CellGroupData[{
Cell[4373, 121, 214, 4, 54, "Subsection",ExpressionUUID->"6235391a-be51-4697-b108-1da0bb0a2436"],
Cell[4590, 127, 532, 11, 52, "Input",ExpressionUUID->"27a407c4-c272-42a6-8efc-187e75ac29ee"],
Cell[5125, 140, 1285, 35, 136, "Input",ExpressionUUID->"0fce930d-955e-4a77-a06c-f2a1d3427cb6"],
Cell[CellGroupData[{
Cell[6435, 179, 752, 18, 94, "Input",ExpressionUUID->"0478cbea-a17b-4712-b5ce-4c5ad1afbbd4"],
Cell[7190, 199, 623, 12, 34, "Output",ExpressionUUID->"b5222b4a-0b4d-49f3-963a-c4e8c02b9cf5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7850, 216, 440, 11, 52, "Input",ExpressionUUID->"1df45b87-45ec-43ff-83b1-c566b8051491"],
Cell[8293, 229, 456, 8, 34, "Output",ExpressionUUID->"c17759fc-3516-4104-b59f-fcf9dacec214"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8786, 242, 441, 11, 52, "Input",ExpressionUUID->"b522e711-6a26-4dbe-b3cf-3fc936454036"],
Cell[9230, 255, 514, 9, 34, "Output",ExpressionUUID->"e6765383-37bb-41b5-a1d3-57ee234f1200"]
}, Open  ]],
Cell[9759, 267, 1489, 39, 178, "Input",ExpressionUUID->"f663403d-e476-4d25-a6cb-6be614579cb5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11285, 311, 264, 4, 54, "Subsection",ExpressionUUID->"ac265462-18bf-4df6-97bf-0e4e7491d3ca"],
Cell[11552, 317, 608, 12, 52, "Input",ExpressionUUID->"b82e591e-007a-482a-a258-b21706477bd5"],
Cell[12163, 331, 1596, 41, 178, "Input",ExpressionUUID->"4987ded2-6106-4b40-85f2-6456e3e6cb95"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13796, 377, 94, 1, 54, "Subsection",ExpressionUUID->"6ee8de52-8028-46fb-8324-7f3de20850fb"],
Cell[13893, 380, 784, 21, 52, "Input",ExpressionUUID->"8ee6f682-5cb8-4a9b-9a6b-b9fb3d5d879e"],
Cell[14680, 403, 1051, 31, 80, "Input",ExpressionUUID->"e6560500-7bec-43bb-9447-fe6bb0725ba7"],
Cell[15734, 436, 757, 21, 52, "Input",ExpressionUUID->"37ee9a46-9904-4c3f-b9ad-0914e87e60a5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16540, 463, 170, 3, 67, "Section",ExpressionUUID->"eaee646b-c165-40de-8d18-1174a0d57ad3"],
Cell[16713, 468, 1010, 27, 47, "Input",ExpressionUUID->"7f5fbb28-c1e4-47d6-b3dc-15eb5742afbe"],
Cell[17726, 497, 730, 24, 67, "Input",ExpressionUUID->"15241764-f98f-4547-bb85-906d85966893"],
Cell[18459, 523, 854, 26, 67, "Input",ExpressionUUID->"0d7ce3b7-9355-4b58-8e94-d5d3014b79f8"],
Cell[19316, 551, 294, 6, 30, "Input",ExpressionUUID->"740b6843-a2d4-48b5-9ab5-8c2ba4a41693"],
Cell[19613, 559, 951, 23, 82, "Input",ExpressionUUID->"b9a8e169-5f9c-4436-8661-e8ead8eb7683"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20601, 587, 160, 3, 67, "Section",ExpressionUUID->"ad104d27-00b8-4fe6-9781-e3982b2c2ae1"],
Cell[CellGroupData[{
Cell[20786, 594, 200, 3, 54, "Subsection",ExpressionUUID->"e6c0b09e-73f5-41ae-bb51-247c7f5e0189"],
Cell[20989, 599, 1796, 51, 170, "Input",ExpressionUUID->"37939309-7501-4e54-8d98-3f69c7bc9bca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22822, 655, 251, 4, 54, "Subsection",ExpressionUUID->"768bf1db-87e7-471f-95bf-69ca3693c211"],
Cell[23076, 661, 144, 3, 35, "Text",ExpressionUUID->"717ad0dd-5c5f-437e-8921-054a5e325877"],
Cell[23223, 666, 1445, 41, 167, "Input",ExpressionUUID->"7824c651-46e5-46ea-a030-d2135468e01c"],
Cell[24671, 709, 153, 3, 35, "Text",ExpressionUUID->"1a3dc62b-2f3d-49a3-91ab-146a5c59cd1a"],
Cell[24827, 714, 1541, 40, 186, "Input",ExpressionUUID->"9e0ee1a2-91ba-456f-a266-b3469bdfd84e"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[26417, 760, 160, 3, 53, "Section",ExpressionUUID->"d8720cf6-94a0-4e31-bbc8-f43b6952d17a"],
Cell[CellGroupData[{
Cell[26602, 767, 194, 3, 54, "Subsection",ExpressionUUID->"e0121f01-3dc3-474c-8d74-1dff1ebbae57"],
Cell[26799, 772, 1536, 40, 95, "Input",ExpressionUUID->"8e601f1c-df87-4c6d-b31c-792d7b89b69a"],
Cell[28338, 814, 934, 22, 74, "Input",ExpressionUUID->"b4b38c64-9812-4ffa-ac2f-b6db4a0dc934"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29309, 841, 243, 4, 54, "Subsection",ExpressionUUID->"0db2a920-0980-484d-a1bd-e2a0955f3082"],
Cell[29555, 847, 1875, 53, 211, "Input",ExpressionUUID->"81939790-b04d-49ca-8bd5-6afee500bbe8"],
Cell[31433, 902, 1975, 57, 212, "Input",ExpressionUUID->"ebb5a143-0bac-4305-ad0a-fcb889983667"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[33457, 965, 91, 1, 53, "Section",ExpressionUUID->"18b06b9e-f6ea-4a0c-823d-fa8beca74c6e"],
Cell[CellGroupData[{
Cell[33573, 970, 204, 3, 54, "Subsection",ExpressionUUID->"9e0ca6a7-0b0c-4e7d-aad5-aead614879a9"],
Cell[33780, 975, 807, 17, 93, "Input",ExpressionUUID->"87380738-ebfc-4be8-88fe-f694c6f48061"],
Cell[34590, 994, 587, 13, 48, "Input",ExpressionUUID->"634917d0-2559-4d52-b2c0-8f321ff11224"],
Cell[35180, 1009, 1026, 29, 95, "Input",ExpressionUUID->"fdeb89b4-373b-4ff7-b1dc-c3c02ced7519"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[36255, 1044, 91, 1, 67, "Section",ExpressionUUID->"29268258-ecd8-4f2b-a97d-6c0825e639b0"],
Cell[CellGroupData[{
Cell[36371, 1049, 202, 3, 54, "Subsection",ExpressionUUID->"d111d3ae-0e2b-48cc-ad8a-c80aee813aca"],
Cell[36576, 1054, 702, 15, 54, "Input",ExpressionUUID->"535f3245-e099-4ac2-b30f-6e3e6fd0fe79"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37315, 1074, 157, 2, 54, "Subsection",ExpressionUUID->"efcdc649-14b5-492d-9a5a-2c1395e13c7f"],
Cell[37475, 1078, 1057, 30, 126, "Input",ExpressionUUID->"c86a5ff0-825d-4344-a579-ec4f2e19758b"],
Cell[38535, 1110, 1027, 31, 86, "Input",ExpressionUUID->"13e9b342-3d70-4ec8-9140-7ecd90795f67"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39599, 1146, 207, 3, 54, "Subsection",ExpressionUUID->"a3ed60ce-13e9-4b06-8142-c1118eb5a938"],
Cell[39809, 1151, 2213, 60, 237, "Input",ExpressionUUID->"770cdf80-7220-4bb4-89d2-637b0db3e415"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[42071, 1217, 212, 4, 67, "Section",ExpressionUUID->"0b13436d-d1d1-4a9d-816b-b230df90b911"],
Cell[CellGroupData[{
Cell[42308, 1225, 219, 4, 54, "Subsection",ExpressionUUID->"72878afa-6ecc-4220-9b83-043f00459bad"],
Cell[42530, 1231, 440, 12, 58, "Input",ExpressionUUID->"215415c4-c3ca-48e0-b094-203952f9dab3"],
Cell[42973, 1245, 529, 13, 59, "Input",ExpressionUUID->"0f9246e0-b71d-4f1f-8f71-82df28ca0110"],
Cell[43505, 1260, 572, 17, 45, "Input",ExpressionUUID->"2f41b708-9503-4586-8d24-aeb40b8cc8df"],
Cell[44080, 1279, 272, 6, 30, "Input",ExpressionUUID->"a9156c8f-e1a1-4680-bb36-9a1cd5563a38"],
Cell[44355, 1287, 642, 16, 50, "Input",ExpressionUUID->"b6a415c1-5e12-4223-9f00-54a3dd00b0ce"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[45046, 1309, 166, 3, 53, "Section",ExpressionUUID->"0774118e-aa81-4929-a777-6b97e4b41c48"],
Cell[CellGroupData[{
Cell[45237, 1316, 184, 3, 54, "Subsection",ExpressionUUID->"a1e58abd-8057-488e-be54-316a0c7f1346"],
Cell[45424, 1321, 2791, 69, 197, "Input",ExpressionUUID->"ae982385-fb1f-487e-9d94-3fd9ededeb28"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48252, 1395, 293, 4, 54, "Subsection",ExpressionUUID->"14f294cd-60d5-47ac-b152-aacaec5cb136"],
Cell[48548, 1401, 1362, 33, 113, "Input",ExpressionUUID->"fec81196-c131-4e97-95ae-516f0a64b771"],
Cell[49913, 1436, 1071, 30, 90, "Input",ExpressionUUID->"f1342642-2b04-478c-8fa8-6e3123b7f858"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51021, 1471, 338, 5, 54, "Subsection",ExpressionUUID->"d641b15e-ef2d-4591-bb20-25a5891265e9"],
Cell[CellGroupData[{
Cell[51384, 1480, 11569, 249, 1265, "Input",ExpressionUUID->"488d312c-8d35-4ada-a69d-97acedbab037"],
Cell[62956, 1731, 5919, 114, 473, "Output",ExpressionUUID->"5a530654-dc7d-457a-af06-cc8214146dba"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[68936, 1852, 104, 1, 53, "Section",ExpressionUUID->"1cb9605a-49c3-4ed4-bea2-4229f7270928"],
Cell[CellGroupData[{
Cell[69065, 1857, 137, 1, 54, "Subsection",ExpressionUUID->"4e01c362-9fa2-47d5-9d05-8833f5e81bba"],
Cell[CellGroupData[{
Cell[69227, 1862, 3400, 77, 367, "Input",ExpressionUUID->"971c0d91-81da-4465-a531-377fe10cbb8b"],
Cell[72630, 1941, 3205, 65, 371, "Output",ExpressionUUID->"f59f5117-701f-4eec-a29f-fc6136d3dc0a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[75884, 2012, 317, 5, 54, "Subsection",ExpressionUUID->"5562437e-7c12-46eb-90d0-0213c04f5733"],
Cell[CellGroupData[{
Cell[76226, 2021, 5263, 123, 451, "Input",ExpressionUUID->"818ffd26-1456-48a4-bca1-057b3ed0b812"],
Cell[81492, 2146, 4177, 85, 381, "Output",ExpressionUUID->"786b631f-b79c-458e-bf89-c0d565dc5c85"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[85718, 2237, 194, 3, 54, "Subsection",ExpressionUUID->"a3bdbdfb-223c-4464-b880-7d276aba9a1d"],
Cell[CellGroupData[{
Cell[85937, 2244, 7259, 172, 730, "Input",ExpressionUUID->"deb776fb-b6e7-4079-9b01-a463352f2c2d"],
Cell[93199, 2418, 4832, 94, 441, "Output",ExpressionUUID->"2d34bbfe-db5e-48ed-b486-885a45581098"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98068, 2517, 7220, 171, 730, "Input",ExpressionUUID->"f43fbd4d-1227-4f2f-9fe6-f8c70577586c"],
Cell[105291, 2690, 4593, 90, 447, "Output",ExpressionUUID->"37da81ad-3957-48f2-a2ca-77b82710abdd"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[109945, 2787, 160, 3, 67, "Section",ExpressionUUID->"7f69b1d9-93d6-4d10-afa6-4080981e44e7"],
Cell[CellGroupData[{
Cell[110130, 2794, 8122, 187, 703, "Input",ExpressionUUID->"3b68d7d5-c975-472d-836f-aa1534d32983"],
Cell[118255, 2983, 6010, 115, 495, "Output",ExpressionUUID->"da67ab5a-2ece-4bd8-96ee-1b7f7abd3c68"]
}, Open  ]],
Cell[124280, 3101, 171, 4, 30, "Input",ExpressionUUID->"76696169-9795-4de0-9711-8b8a1ec1cca0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124488, 3110, 154, 3, 67, "Section",ExpressionUUID->"b4b13f96-0592-485f-b9c5-359b0e23ce9d"],
Cell[CellGroupData[{
Cell[124667, 3117, 204, 3, 54, "Subsection",ExpressionUUID->"da72d9a3-3b27-4862-b272-7b3dd69f6e20"],
Cell[CellGroupData[{
Cell[124896, 3124, 5489, 111, 409, "Input",ExpressionUUID->"422df7dc-53c4-4f0f-9b22-8cd735930d9a"],
Cell[130388, 3237, 3609, 70, 193, "Output",ExpressionUUID->"99e47d7f-df6a-4b26-b05c-c46e199ea1a2"],
Cell[134000, 3309, 964, 15, 55, "Message",ExpressionUUID->"24db62cb-84ef-4efc-9db6-2f9ebc4e2b70"],
Cell[134967, 3326, 964, 15, 55, "Message",ExpressionUUID->"5e1d61b3-187e-4cc2-803c-e8f2b4b89fd4"],
Cell[135934, 3343, 966, 15, 55, "Message",ExpressionUUID->"d1343144-3bc7-4390-952e-199475f1fedc"],
Cell[136903, 3360, 417, 8, 24, "Message",ExpressionUUID->"16093454-1ba8-4532-a54b-6c53fb7e4f74"],
Cell[137323, 3370, 963, 15, 55, "Message",ExpressionUUID->"4d0e1b78-d298-4bd7-bf37-3380166d509c"],
Cell[138289, 3387, 963, 15, 55, "Message",ExpressionUUID->"4dd196a3-5fb3-4e49-b1a3-d77f3e494b0c"],
Cell[139255, 3404, 963, 15, 55, "Message",ExpressionUUID->"89a8f82f-b3d1-4c80-a8f9-8505bf5d4db1"],
Cell[140221, 3421, 419, 8, 24, "Message",ExpressionUUID->"0852f5f0-f0a7-4415-8ea5-655897eb5574"],
Cell[140643, 3431, 965, 15, 55, "Message",ExpressionUUID->"25281041-21ad-429c-a500-a59ea4979589"],
Cell[141611, 3448, 963, 15, 55, "Message",ExpressionUUID->"0426faa6-817f-4a47-8aae-448298a3fc32"],
Cell[142577, 3465, 963, 15, 55, "Message",ExpressionUUID->"f64952e1-4294-494e-ae62-eb6934d3005c"],
Cell[143543, 3482, 419, 8, 24, "Message",ExpressionUUID->"8db1e52e-cc82-4f29-b93f-f500eb77d659"],
Cell[143965, 3492, 963, 15, 55, "Message",ExpressionUUID->"c15abc82-65a4-49f3-9979-86582a936960"],
Cell[144931, 3509, 965, 15, 55, "Message",ExpressionUUID->"d0539625-6f05-416b-8df8-17b2cd65382c"],
Cell[145899, 3526, 963, 15, 55, "Message",ExpressionUUID->"ec848015-3020-4ac9-9fa7-9ce407c5ff68"],
Cell[146865, 3543, 417, 8, 24, "Message",ExpressionUUID->"11061bd4-2af5-4c57-9dd9-c5d77e6ade8d"],
Cell[147285, 3553, 963, 15, 55, "Message",ExpressionUUID->"109d5911-c85f-4270-8562-ccb6006d6f9b"],
Cell[148251, 3570, 963, 15, 55, "Message",ExpressionUUID->"5685aa7f-4a41-4a2b-9b91-76ff02621bb5"],
Cell[149217, 3587, 963, 15, 55, "Message",ExpressionUUID->"7a82c57f-35d6-491f-bf95-f98c5b59ca1e"],
Cell[150183, 3604, 417, 8, 24, "Message",ExpressionUUID->"90b3ca22-8ff8-4f5c-8a11-79d6bf746782"],
Cell[150603, 3614, 960, 15, 55, "Message",ExpressionUUID->"94facfb3-62b7-46b0-aa05-e7ee0bab3b8a"],
Cell[151566, 3631, 960, 15, 55, "Message",ExpressionUUID->"f75ab746-8025-44b6-93f6-f08a9a824ec7"],
Cell[152529, 3648, 960, 15, 55, "Message",ExpressionUUID->"54278261-5221-4972-b800-37d7164b172c"],
Cell[153492, 3665, 413, 8, 24, "Message",ExpressionUUID->"6fb9199d-fd40-4da4-85da-374b4ce87bdf"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[153954, 3679, 244, 4, 38, "Subsection",ExpressionUUID->"9dd5d47a-5b3e-48a7-9212-fe927adaa3ce"],
Cell[CellGroupData[{
Cell[154223, 3687, 4730, 96, 325, "Input",ExpressionUUID->"f9527d05-dfbe-4161-8f3a-068ee5cd4112"],
Cell[158956, 3785, 3393, 68, 167, "Output",ExpressionUUID->"74007e4d-7257-48f0-8d64-0db44c07dd82"],
Cell[162352, 3855, 961, 15, 55, "Message",ExpressionUUID->"8c022254-8884-43d1-b713-c5a4430b5316"],
Cell[163316, 3872, 962, 15, 55, "Message",ExpressionUUID->"0bde1860-b6d1-4519-8e65-d0e9a1cc8789"],
Cell[164281, 3889, 962, 15, 55, "Message",ExpressionUUID->"e2332b5c-2033-4929-9aef-a71c71d165c0"],
Cell[165246, 3906, 417, 8, 24, "Message",ExpressionUUID->"d19771c0-4ae9-4bd7-8634-77229e17054f"],
Cell[165666, 3916, 961, 15, 55, "Message",ExpressionUUID->"32379b7a-1151-41bd-a2a3-9761efbb499a"],
Cell[166630, 3933, 964, 15, 55, "Message",ExpressionUUID->"38cbc0c4-ca22-4d0c-b01e-363167a4d27b"],
Cell[167597, 3950, 962, 15, 55, "Message",ExpressionUUID->"51aad461-1bdd-4516-b2e5-8540860d599e"],
Cell[168562, 3967, 417, 8, 24, "Message",ExpressionUUID->"f6132590-5bd7-46f6-a875-4b3d83274d3d"],
Cell[168982, 3977, 853, 15, 59, "Message",ExpressionUUID->"9e7a9e53-7d12-40d7-a690-ca7dc734144c"],
Cell[169838, 3994, 821, 14, 59, "Message",ExpressionUUID->"710203c6-ed66-4ee8-b59b-310613493040"],
Cell[170662, 4010, 912, 16, 59, "Message",ExpressionUUID->"66a6c29e-5a1d-4850-902c-a6dc6823a148"],
Cell[171577, 4028, 1251, 20, 59, "Message",ExpressionUUID->"43bd17e4-223f-4ef2-9198-b548da071642"],
Cell[172831, 4050, 448, 9, 24, "Message",ExpressionUUID->"d483f1ef-289b-4c30-925a-f3e9c9a61640"],
Cell[173282, 4061, 501, 10, 42, "Message",ExpressionUUID->"8e019047-d28c-49b8-9a46-37730009658a"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[173832, 4077, 343, 5, 38, "Subsection",ExpressionUUID->"e9932eea-445e-439c-ac69-cfc529d70a8d"],
Cell[CellGroupData[{
Cell[174200, 4086, 5560, 112, 409, "Input",ExpressionUUID->"91e13757-9cef-4779-987c-4892b2e8190d"],
Cell[179763, 4200, 4161, 78, 179, "Output",ExpressionUUID->"07fbab13-90bd-4231-b0d0-e6454c9d386e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[183973, 4284, 283, 4, 54, "Subsection",ExpressionUUID->"10391084-cb56-4ac4-bc75-c547f24e44ec"],
Cell[CellGroupData[{
Cell[184281, 4292, 4783, 97, 325, "Input",ExpressionUUID->"abe23d67-6c10-4f80-832a-47f3929b2acd"],
Cell[189067, 4391, 3402, 68, 167, "Output",ExpressionUUID->"33f758a7-85d3-4d28-84d8-47bb8f9b51ae"],
Cell[192472, 4461, 965, 15, 55, "Message",ExpressionUUID->"e9b1f024-6a1b-49a7-a8a8-7586be8860a8"],
Cell[193440, 4478, 963, 15, 55, "Message",ExpressionUUID->"c935f918-221b-40d5-93b8-9aefbb6934c8"],
Cell[194406, 4495, 963, 15, 55, "Message",ExpressionUUID->"7f845559-00e9-4bde-8d88-3b358607a2b1"],
Cell[195372, 4512, 417, 8, 24, "Message",ExpressionUUID->"089b5f1a-5fbf-47a9-94e9-f12f7100a1dc"],
Cell[195792, 4522, 965, 15, 55, "Message",ExpressionUUID->"52319290-a882-4ce1-949e-1ad3ee92a262"],
Cell[196760, 4539, 962, 15, 55, "Message",ExpressionUUID->"a1bc9a84-0fe3-4999-938c-2fcdd4acc309"],
Cell[197725, 4556, 963, 15, 55, "Message",ExpressionUUID->"5b2c7137-2d19-402d-9abe-48fcf1fa795b"],
Cell[198691, 4573, 417, 8, 24, "Message",ExpressionUUID->"21de31fa-bb87-4f96-a9fc-4bf526b05342"],
Cell[199111, 4583, 967, 15, 55, "Message",ExpressionUUID->"9b8bff83-66d4-43d6-ae95-2153cd1c9212"],
Cell[200081, 4600, 967, 15, 55, "Message",ExpressionUUID->"6d478ee6-1047-4df3-8d87-c88656b6c29a"],
Cell[201051, 4617, 965, 15, 55, "Message",ExpressionUUID->"a651af39-320f-4a86-a7d2-963998bfef69"],
Cell[202019, 4634, 417, 8, 24, "Message",ExpressionUUID->"f7979294-5c12-4423-9e54-a9efd399b8aa"],
Cell[202439, 4644, 965, 15, 55, "Message",ExpressionUUID->"b1535041-fcad-40d0-a618-0d06070299f4"],
Cell[203407, 4661, 965, 15, 55, "Message",ExpressionUUID->"0ae5a0bf-53bf-4f2d-9a53-8a0a52a9daea"],
Cell[204375, 4678, 965, 15, 55, "Message",ExpressionUUID->"3a0dff93-69af-4a34-a16a-4b4bb1cb7c7f"],
Cell[205343, 4695, 417, 8, 24, "Message",ExpressionUUID->"67272e8a-74ab-42cc-9496-50a5d878d750"],
Cell[205763, 4705, 961, 15, 55, "Message",ExpressionUUID->"20c7e1cd-ab72-45cd-a76b-cc9a03253d5a"],
Cell[206727, 4722, 961, 15, 55, "Message",ExpressionUUID->"7fcd9412-f57d-4fee-b100-75d05d77d73a"],
Cell[207691, 4739, 960, 15, 55, "Message",ExpressionUUID->"0677754b-3d42-4e84-903a-53d1e038fdc1"],
Cell[208654, 4756, 415, 8, 24, "Message",ExpressionUUID->"c733957a-3fa6-4634-affd-318a9dc4635d"],
Cell[209072, 4766, 499, 10, 24, "Message",ExpressionUUID->"c6ee9e41-f409-4ad8-9098-d4fba96d9e09"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[209632, 4783, 157, 3, 53, "Section",ExpressionUUID->"933a287f-e8a3-415a-86d8-05bde0677de4"],
Cell[CellGroupData[{
Cell[209814, 4790, 248, 4, 54, "Subsection",ExpressionUUID->"cd4ede3b-dade-468a-a4af-937a542fbbea"],
Cell[CellGroupData[{
Cell[210087, 4798, 9584, 202, 1062, "Input",ExpressionUUID->"77367875-19c6-4311-b6ed-2d75ea4fbc66"],
Cell[219674, 5002, 6181, 114, 497, "Output",ExpressionUUID->"32924555-153b-4d08-b366-642b8a367765"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

